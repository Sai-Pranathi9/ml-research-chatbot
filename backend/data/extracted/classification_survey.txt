COMPUTING SPECTRAL MEASURES OF SELF-ADJOINT
OPERATORSâˆ—
MATTHEW COLBROOKâ€ , ANDREW HORNINGâ€¡, AND ALEX TOWNSENDÂ§
Abstract. Using the resolvent operator, we develop an algorithm for computing smoothed ap-
proximations of spectral measures associated with self-adjoint operators. The algorithm can achieve
arbitrarily high-orders of convergence in terms of a smoothing parameter for computing spectral
measures of general diï¬€erential, integral, and lattice operators.
Explicit pointwise and Lp-error
bounds are derived in terms of the local regularity of the measure. We provide numerical examples,
including a partial diï¬€erential operator, a magnetic tight-binding model of graphene, and compute
one thousand eigenvalues of a Dirac operator to near machine precision without spectral pollution.
The algorithm is publicly available in SpecSolve, which is a software package written in MATLAB.
Key words. spectrum, spectral measures, resolvent, spectral methods, rational kernels
AMS subject classiï¬cations. 47A10, 46N40, 47N50, 65N35, 81Q10
1. Introduction. The spectrum of a ï¬nite matrix consists only of discrete eigen-
values; however, many of the inï¬nite-dimensional operators in mathematical analysis
and physical applications include a continuous spectral component [59,100]. Notably,
eigenvalues and eigenvectors do not diagonalize operators with continuous spectra,
and one needs extra information to fully describe the operator and associated dy-
namics of physical models [46, 109].
Given a self-adjoint operator L acting on a
Hilbert space H, the spectral measure (see (2.2)) of L is a quantity of great inter-
est because it provides an analogue of diagonalization through the spectral theo-
rem (see section 2). Spectral measures are related to correlation in stochastic pro-
cesses and signal-processing [43, 58] [89, Ch. 7], scattering cross-sections in particle
physics [32â€“34], the local density-of-states in crystalline materials [5,49,69], and many
other quantities [24,27,61,114,119]. Furthermore, through spectral measures one can
compute the functional calculus of L, which is used to solve evolution equations such
as the SchrÂ¨odinger equation in quantum mechanics [51,71].
The eigenvalues and eigenvectors of an inï¬nite-dimensional operator with dis-
crete spectrum are usually computed by discretizing and employing a matrix eigen-
solver [9,12]. Computing spectral measures is more subtle, and previous eï¬€orts have
mainly focused on operators where analytical formulas or heuristics are available
(see section 3). Building on [15, 54], we develop a general framework for computing
approximations to spectral measures of operators that only requires two capabilities:
1. A numerical solver for shifted linear equations, i.e., (L âˆ’z)u = f with z âˆˆC.
2. Numerical approximations to inner products of the form âŸ¨u, fâŸ©.
Here, âŸ¨Â·, Â·âŸ©is the inner product associated with H, which can be general provided one
can compute âŸ¨u, fâŸ©. We develop high-order rational convolution kernels that allow us
to construct accurate approximations to spectral measures by solving the shifted linear
equations (see Table 5.1 and Figure 5.1). Error bounds show that our approximations
to the spectral measure converge rapidly (see Theorems 5.2 and 5.3).
We apply
âˆ—Submitted to the editors December 2, 2020.
Funding: The ï¬rst author was supported by EPSRC grant EP/L016516/1. The work of the
second and third authors is supported by the National Science Foundation grant no. 1818757.
â€ Department of Applied Mathematics and Theoretical Physics, University of Cambridge, Cam-
bridge, CB3 0WA. (m.colbrook@damtp.cam.ac.uk)
â€¡Center for Applied Mathematics, Cornell University, Ithaca, NY 14853. (ajh326@cornell.edu)
Â§Department of Mathematics, Cornell University, Ithaca, NY 14853. (townsend@cornell.edu)
1
Preprint for review purposes only.
arXiv:2006.01766v2  [math.NA]  1 Dec 2020
2
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
our algorithm to diï¬€erential (see subsection 7.1), integral (see subsection 4.1), and
lattice (see subsection 7.2) operators to demonstrate its versatility, high accuracy, and
robustness. We also use our approximations of spectral measures to compute the ï¬rst
thousand eigenvalues of a Dirac operator (corresponding to bound states in the gap of
the essential spectrum) without spectral pollution (see subsection 7.3). Thus, spectral
measures are also a useful tool for the computation of discrete spectra when there are
gaps in the essential spectrum or when discrete spectra cluster (see subsections 7.2
and 7.3). To accompany this paper, we have developed a publicly available MATLAB
package called SpecSolve for computing spectral measures of a large class of self-
adjoint operators [19].
The paper is organized as follows. We recall the deï¬nition of the spectral measure
of an operator in section 2 and survey existing algorithms in section 3. In section 4,
we introduce our computational framework and derive high-order versions in sec-
tion 5. In section 6 we discuss algorithmic issues and tackle challenging applications
in section 7. Finally, we point out additional capabilities and use of the algorithm
in section 8.
2. The spectral measure of a self-adjoint operator. Any linear operator
acting on a ï¬nite-dimensional Hilbert space has a purely discrete spectrum consisting
of eigenvalues. In particular, the spectral theorem for self-adjoint A âˆˆCnÃ—n states
that there exists an orthonormal basis of eigenvectors v1, . . . , vn for Cn such that
(2.1)
v =
 n
X
k=1
vkvâˆ—
k
!
v,
v âˆˆCn
and
Av =
 n
X
k=1
Î»kvkvâˆ—
k
!
v,
v âˆˆCn,
where Î»1, . . . , Î»n are eigenvalues of A, i.e., Avk = Î»kvk for 1 â‰¤k â‰¤n. In other words,
the projections vkvâˆ—
k decompose Cn and diagonalize A.
In the inï¬nite-dimensional setting, we replace v âˆˆCn by f âˆˆH, and A by a self-
adjoint operator L with domain D(L) âŠ‚H.1 If L has non-empty continuous spectrum,
then eigenfunctions of L do not form a basis for H or diagonalize L. However, the
spectral theorem for self-adjoint operators states that the projections vkvâˆ—
k in (2.1)
can be replaced by a projection-valued measure E [87, Thm. VIII.6]. The measure E
assigns an orthogonal projector to each Borel-measurable set such that
f =
Z
R
dE(y)

f,
f âˆˆH
and
Lf =
Z
R
y dE(y)

f,
f âˆˆD(L).
Analogous to (2.1), E decomposes H and diagonalizes the operator L.
The spectral measure of L with respect to f âˆˆH is a scalar measure deï¬ned
as Âµf(â„¦) := âŸ¨E(â„¦)f, fâŸ©, where â„¦âŠ‚R is a Borel-measurable set [87]. It is useful to
examine Lebesgueâ€™s decomposition of Âµf [97], i.e.,
(2.2)
dÂµf(y) =
X
Î»âˆˆÎ›p(L)
âŸ¨PÎ»f, fâŸ©Î´(y âˆ’Î»)dy
|
{z
}
discrete part
+ Ïf(y) dy + dÂµ(sc)
f
(y)
|
{z
}
continuous part
.
The discrete part of Âµf is a sum of Dirac delta distributions, supported on the set
of eigenvalues of L, which we denote by Î›p(L). The coeï¬ƒcient of each Î´ in the sum
is âŸ¨PÎ»f, fâŸ©= âˆ¥PÎ»fâˆ¥2, where PÎ» is the orthogonal spectral projector associated with
1Considering L : D(L) â†’H allows us to treat unbounded operators such as diï¬€erential operators.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
3
the eigenvalue Î», and âˆ¥Â· âˆ¥=
p
âŸ¨Â·, Â·âŸ©is the norm on H. The continuous part of Âµf
consists of an absolutely continuous2 part with Radonâ€“Nikodym derivative Ïf âˆˆL1(R)
and a singular continuous component Âµ(sc)
f
. Without loss of generality, we assume
throughout that âˆ¥fâˆ¥= 1, which ensures that Âµf is a probability measure.
Many operators have non-empty continuous spectra [59, Ch. 10] such as self-
adjoint Toeplitz operators on â„“2(N) (square summable sequences, where N = {1, 2, ...})
[8], diï¬€erential operators on bounded domains with singular variable coeï¬ƒcients [44,
66] and unbounded domains [108, Ch. V] [30, Ch. XIII,Ch. XIV], and integral per-
turbations of multiplication operators and Cauchy-type integral operators [37,62]. In
physical systems that scatter or radiate energy, the associated operator typically has
a mix of continuous and discrete spectra, e.g., see RAGE theorem [2, 35, 90]. We
aim to evaluate smoothed approximations of Âµf when L has a non-empty continuous
spectrum. This means that we compute samples from a smooth function gÏµ, with
smoothing parameter Ïµ > 0, that converges weakly to Âµf [6, Ch. 1]. That is,
Z
R
Ï†(y)gÏµ(y) dy â†’
Z
R
Ï†(y) dÂµf(y),
as
Ïµ â†“0,
for any bounded, continuous function Ï†. Approximation properties and explicit con-
vergence bounds are studied in sections 4 and 5.
3. Applications of spectral measures. Spectral measures appear in many
traditional topics of applied analysis, such as ordinary (ODEs) and partial diï¬€erential
equations (PDEs), stochastic processes, orthogonal polynomials, and random matrix
theory. Here, we give a brief survey of existing algorithms for computing Âµf and
closely related quantities.
3.1. Particle and condensed matter physics. Spectral measures are prom-
inent in quantum mechanics [47, 87], where a self-adjoint operator L represents an
observable quantity, and Âµf describes the likelihood of diï¬€erent outcomes when the
observable is measured (see subsection 5.2). In this setting, f âˆˆH with âˆ¥fâˆ¥= 1
represents a quantum state. For example, in quantum models of interacting parti-
cles, spectral measures of many-body Hamiltonians are used to study the response
of a quantum system to perturbations [32]. In condensed matter physics, spatially-
resolved statistical properties of materials are analyzed using the local density-of-
states3 (LDOS) of an n Ã— n matrix An [60, Ch. 6.4], which is the spectral measure
of An taken with respect to a vector b [69]. Here, An is typically a discretized or
truncated Hamiltonian and one is interested in the thermodynamic limit n â†’âˆ, so
that An is too large to compute a full eigenvalue decomposition.
There are two main classes of numerical methods for computing these measures.
One class constructs smooth global approximations of the measure with explicit
moment-matching procedures [65, 92, 118], while another class exploits a connection
between the spectral measure and the resolvent operator to evaluate samples from a
smoothed approximation to the measure [5,33,49]. For example, the so-called recur-
sion method [5,49] evaluates the resolvent of tridiagonal Hamiltonians using associated
continued-fraction expansions. Resolvent techniques to compute the DOS of ï¬nite ma-
trices also appear in the study of random matrices and SchrÂ¨odinger operators, where
the connection is made through the Stieltjes transform [4,10].
2We take â€œabsolutely continuousâ€ to be with respect to Lebesgue measure.
3This is distinct from the global density-of-states (DOS), which is formally obtained from the
LDOS via an averaging procedure [60, Ch. 6.4].
Preprint for review purposes only.
4
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
The resolvent of an operator L with spectrum Î›(L) is given by [59, p. 173]
(3.1)
RL(z) = (L âˆ’z)âˆ’1,
z âˆˆC \ Î›(L).
In section 4, we evaluate a smoothed approximation of Âµf by evaluating the resol-
vent function âŸ¨RL(z)f, fâŸ©in the upper half-plane, i.e., Im(z) > 0. Our approach is
closely related to the second class of methods developed for operators in quantum me-
chanics. A key theme in the above moment-matching and resolvent-based approaches
is smoothing, which is introduced by convolution with a smoothing kernel to avoid
diï¬ƒculties associated with the singular part of the measure [69]. The smoothed ap-
proximations of the spectral measures that we compute in sections 4 and 5 also have
the form of KÏµ âˆ—Âµf, where KÏµ is a smoothing kernel with smoothing parameter Ïµ > 0.
Our framework is â€œdiscretization-oblivious,â€ in the sense that it directly resolves
the spectral measure of an inï¬nite-dimensional L, and not an underlying discretiza-
tion. This means that our algorithms do not suï¬€er from spectral pollution.4 Moreover,
our framework can be used with any accurate numerical method for solving linear op-
erator equations and computing inner products, making it applicable to diï¬€erential,
integral, and lattice operators.
Achieving a discretization-oblivious framework re-
quires balancing reï¬nement in the computation of âŸ¨RL(z)f, fâŸ©and reï¬nement in the
smoothing parameter, which we do in a principled way (see subsection 4.3).
3.2. Time evolution and spectral density estimation. Spectral measures
provide a useful lens when studying processes that evolve over time. Suppose that
u : [0, T] â†’H evolves over time according to the abstract Cauchy problem
(3.2)
du
dt = âˆ’iLu,
u(0) = f âˆˆH,
where L is a self-adjoint operator. For example, (3.2) could describe the evolution of
a quantum system according to the SchrÂ¨odinger equation [71]. Semigroup theory [81]
shows that the solution to (3.2) is given by the operator exponential eâˆ’iLtf. The
autocorrelation function of u is of interest, i.e.,
âŸ¨u(t), fâŸ©= âŸ¨eâˆ’iLtf, fâŸ©=
Z
R
eâˆ’iyt dÂµf(y),
t âˆˆ[0, T],
which can reveal features that persist over time [105]. This interpretation of a time
evolution process is quite ï¬‚exible and can be adapted to describe many signals, u,
generated by PDEs [26,55,94] and stochastic processes [43,58] [89, Ch. 7].
In certain evolution processes, Âµf is referred to as the spectral density of u [21].
The task of spectral density estimation is to recover Âµf from samples of u(t) [99,
Ch. 1.5]. A popular technique used in spectral density estimation, related to statistical
kernel density estimation [115, 116], reconstructs a smoothed approximation to Âµf
by convolving the empirical measure (a discrete measure supported on the observed
samples) with a smoothing kernel [78,83]. The particular choice of smoothing kernel
aï¬€ects the convergence properties of the smoothed spectral density [79].
In analogy to the variance-bias tradeoï¬€encountered when selecting the smoothing
parameter in statistical kernel density estimation [80, 88], our smoothed approxima-
tions, KÏµ âˆ—Âµf, exhibit a tradeoï¬€between numerical cost and smoothing (see sub-
section 4.3).
In section 5, we adapt arguments from kernel density estimation to
determine what properties a smoothing kernel needs to achieve a high-order of con-
vergence in the smoothing parameter.
4Spectral pollution is the phenomenon of eigenvalues of ï¬nite discretizations/truncations clus-
tering at points not in the spectrum of L as the truncation size increases.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
5
3.3. Sturmâ€“Liouville and Jacobi operators. Spectral density functions are
used in the analysis of singular Sturmâ€“Liouville problems and related classes of self-
adjoint operators [72]. A subtle distinction between spectral measures Âµf and the
spectral density function associated with a Sturmâ€“Liouville problem is that the latter
does not depend on a given vector f. Instead, the spectral density function corre-
sponds to the multiplicative version of the spectral theorem [87, Thm. VIII.4], which
induces a Fourier transform-type pair [14]. However, computational methods for both
spectral quantities share similarities. For example, one can compute spectral density
functions using a Plemelj-type formula [119], which is similar to (4.1).
A common approach to computing spectral density functions associated with
Sturmâ€“Liouville operators on unbounded domains is to truncate the domain and
take an appropriate limit of an eigenvalue counting function, as implemented in the
software package SLEDGE [40,41,84]. This is similar in spirit to DOS calculations,
though convergence analysis remains challenging due to the truncation of the inï¬nite
interval [85]. This approach can be computationally expensive since the eigenvalues
cluster as the domain size increases; often, hundreds of thousands of eigenvalues and
eigenvectors need to be computed. One can avoid this cost for certain operators by
leveraging analytic limit formulas and solving an ODE at each evaluation point of
the spectral density function [38,39]. Similar methods apply to compute the inverse
scattering transform for the Toda lattice and the KdV equation [7,114].
For a Jacobi operator J on â„“2(N), under suitable conditions [106, Ch. 2], the
spectral measure Âµe1 of J (e1 denotes the ï¬rst canonical basis vector) coincides with
the measure given by the multiplicative version of the spectral theorem. Moreover,
Âµe1 is the probability measure associated with the orthonormal polynomials whose
three-term recurrence relation is associated with J [25]. Due to this connection, the
study of spectral measures has a rich history in the theory of orthogonal polynomials
and quadrature rules for numerical integration [25, 27, 68, 103, 106]. In special cases,
one can recover a distribution function for Âµe1 as a limit of functions constructed using
Gaussian quadrature [13, Ch. 2]. One can even use connection coeï¬ƒcients between
families of orthogonal polynomials to compute spectral measures of Jacobi operators
that arise as compact perturbations of Toeplitz operators [117]. Applications in this
direction include quantum theory and random matrix theory [42,61,95].
While these approaches are specialized to a selected class of operators, we focus
on developing a general framework to deal rigorously with arbitrary order ODEs and
PDEs (see subsection 7.1), and integral operators (see subsection 4.1).
The price
we pay for this generality is the need to solve shifted linear systems close to the
operatorâ€™s spectrum. We demonstrate that this can be done robustly with fast, well-
conditioned, and spectrally accurate methods (see section 6). Similarly, we aim to
build a framework that treats general discrete or lattice operators (see subsection 6.3).
4. Resolvent-based approach to evaluate the spectral measure. The key
to our framework for computing spectral measures is the resolvent of L (see (3.1)).
A classical result in operator theory is Stoneâ€™s formula, which says that the spectral
measure of L can be recovered from the jump in the resolvent RL(z) across the real
axis [101] [87, Thm. VII.13]. More precisely, if we select Ïµ > 0 and regard RL(x + iÏµ)
as a function of the real variable x, then we have that
(4.1)
1
2Ï€iâŸ¨(RL( Â· + iÏµ) âˆ’RL( Â· âˆ’iÏµ))f, fâŸ©= 1
Ï€Im(âŸ¨RL( Â· + iÏµ)f, fâŸ©) â†’Âµf as Ïµ â†“0.
Here, the equality is due to the conjugate symmetry of RL(z) across the real axis and
the limit should be understood in the sense of weak convergence of measures.
Preprint for review purposes only.
6
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
Stoneâ€™s formula is a consequence of the functional calculus identity
(4.2)
âŸ¨RL(x + iÏµ)f, fâŸ©=
Z
R
dÂµf(y)
y âˆ’(x + iÏµ).
By using (4.2) to rewrite (4.1), we arrive at an expression for the jump over the real
axis as a convolution of the spectral measure with the Poisson kernel, i.e.,
(4.3)
1
Ï€ Im(âŸ¨RL(x + iÏµ)f, fâŸ©) = 1
Ï€
Z
R
Ïµ
Ïµ2 + (x âˆ’y)2 dÂµf(y).
The Poisson kernel is one of the most common kernels used to smooth approximations
of measures in particle and condensed matter physics (see the discussion in subsec-
tion 3.1). When L has no singular continuous spectrum, substituting the spectral
measure given in (2.2) into the expression (4.3) shows that RL(x + iÏµ) provides an
approximation to both the discrete and continuous components of the measure Âµf for
Ïµ > 0. That is,
(4.4)
1
Ï€ Im(âŸ¨RL(x + iÏµ)f, fâŸ©) = 1
Ï€
X
Î»âˆˆÎ›p(L)
Ïµ âŸ¨PÎ»f, fâŸ©
Ïµ2 + (x âˆ’Î»)2 + 1
Ï€
Z
R
Ïµ Ïf(y)
Ïµ2 + (x âˆ’y)2 dy.
The contribution from the sum in (4.4) is a series of Poisson kernels centered at the
eigenvalues and scaled by the corresponding coeï¬ƒcients âŸ¨PÎ»f, fâŸ©for Î» âˆˆÎ›p(L). As
Ïµ â†“0, the sum converges to a series of Dirac delta distributions representing the
discrete part of the measure in (2.2). Meanwhile, the integral in (4.4) contributes a
smoothed approximation to the Radonâ€“Nikodym derivative Ïf.
Motivated by (4.4), we select Ïµ > 0 and approximate samples of Âµf by evaluating
(4.5)
ÂµÏµ
f(x) := 1
Ï€Im(âŸ¨RL(x + iÏµ)f, fâŸ©) .
From (4.1), we know that as Ïµ â†“0 we have ÂµÏµ
f â†’Âµf in the sense of weak convergence of
measures. Moreover, if Âµf has some additional local regularity about a point x0 âˆˆR,
then ÂµÏµ
f(x0) â†’Ïf(x0) as Ïµ â†“0 (see Theorem 4.1). There is a two-step procedure for
evaluating ÂµÏµ
f(x0) at some x0 âˆˆR, which is immediate from (4.5):
1. Solve the shifted linear equation for uÏµ:
(4.6)
(L âˆ’x0 âˆ’iÏµ)uÏµ = f,
uÏµ âˆˆD(L).
2. Compute the inner product ÂµÏµ
f(x0) = 1
Ï€Im(âŸ¨uÏµ, fâŸ©).
In practice, the smaller Ïµ>0, the more computationally expensive it is to evaluate (4.5)
because if x0 âˆˆÎ›(L) then the resolvent operator RL(x0 + iÏµ) is unbounded in the
limit Ïµ â†“0. One often computes ÂµÏµ
f(x0) for successively smaller Ïµ to obtain a sequence
that converges to Âµf(x0). For example, Richardsonâ€™s extrapolation can improve the
convergence rate in Ïµ [15], which can be proven using the machinery of section 5.
Typically, one wants to sample ÂµÏµ
f at several points x1, . . . , xm âˆˆR, and then
construct a local or global representation of ÂµÏµ
f for visualization or further computa-
tions. If one wants to visualize ÂµÏµ
f in an interval, then we recommend evaluating at
equispaced points in that interval. However, when one wants to calculate an integral
with respect to ÂµÏµ
f, it is better to evaluate ÂµÏµ
f at quadrature nodes (see subsection 5.2).
Note that if xj Ì¸âˆˆÎ›(L), then ÂµÏµ
f(xj) â†’0 as Ïµ â†“0 (for example, see Figure 4.1).
Although singular continuous spectrum may appear to be an exotic phenomenon,
it occurs in applications of practical interest. For example, discrete SchrÂ¨odinger op-
erators with aperiodic potentials on â„“2(Z) (such as the Fibonacci Hamiltonian) can
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
7
-2
-1
0
1
2
10-4
10-2
100
102
ÂµÏµ
f(x)
x
Ïµ = 0.001
Ïµ = 0.01
Ïµ = 0.1
-2
-1
0
1
2
10-4
10-2
100
102
-0.5
-0.45
-0.4
-0.35
-0.3
10-1
100
ÂµÏµ
f(x)
x
Ïµ = 0.001
Ïµ = 0.01
Ïµ = 0.1
Figure 4.1. Left: The smoothed approximation ÂµÏµ
f for the integral operator in (4.7) and dif-
ferent Ïµ. The discretization sizes for solving the shifted linear systems are adaptively selected. The
dashed line corresponds to the spectral measure of the operator given by u(x) â†’xu(x). Adding the
compact perturbation (the integral term) alters the shape of the measure over [âˆ’1, 1] and there is an
additional eigenvalue near x â‰ˆ1.37. Right: The same computation except with a ï¬xed discretization
size of N = 300 to solve (4.6). The magniï¬ed region shows spurious high-frequency oscillations for
Ïµ = 0.001, an artifact caused by the discrete spectrum of the underlying discretization.
have spectra that are Cantor sets with purely singular continuous spectral measures
(see [3,22,23,45,86,102]). When Î›(L) has a non-zero singular continuous component,
ÂµÏµ
f â†’Âµf weakly as Ïµ â†“0 and our algorithms can compute Âµf(U) (for open sets U)
and the functional calculus of L.5
4.1. Evaluating the spectral measure of an integral operator. To illus-
trate our evaluation strategy, consider the integral operator deï¬ned by
(4.7)
[Lu](x) = xu(x) +
Z 1
âˆ’1
eâˆ’(x2+y2)u(y) dy,
x âˆˆ[âˆ’1, 1],
u âˆˆL2([âˆ’1, 1]).
The integral operator L in (4.7) has continuous spectrum in [âˆ’1, 1], due to the xu(x)
term, and discrete spectrum in R \ [âˆ’1, 1] from the integral term (a compact per-
turbation [59]). Figure 4.1 (left) shows three smoothed approximations of Âµf with
f(x) =
p
3/2 x, for smoothing parameter Ïµ = 0.1, 0.01, and 0.001. We see the pres-
ence of an eigenvalue near x â‰ˆ1.37 from a spike in the smoothed measure that
approximates a Dirac delta .
To perform the two-step procedure described above on a computer, one must
discretize the operator L, and we do this by discretizing L with an N Ã— N matrix
corresponding to an adaptive Chebyshev collocation scheme.6 While the precise dis-
cretization details are delayed until subsection 6.2, Figure 4.1 illustrates the critical
role that N plays when evaluating ÂµÏµ
f. In particular, there are two limits to take in
theory: N â†’âˆand Ïµ â†“0. It is known that these two limits must be taken with con-
siderable care [15]. If N is kept ï¬xed as one takes Ïµ â†“0, then the computed samples of
ÂµÏµ
f do not converge (see Figure 4.1 (right)) because the computed samples get polluted
by the discrete spectrum of the discretization. Instead, as one takes Ïµ â†“0, one must
5In general, it is also impossible to design a black-box method that separates the singular con-
tinuous component of Âµf from the other components. This is made precise in [15], which uses the
framework of the Solvability Complexity Index (SCI) hierarchy [16â€“18].
6While N Ã—N discretizations converge for Fredholm operators [56], square truncations of spectral
discretizations of operators may not always converge. Instead, one may need to take rectangular
truncations to ensure that discretizations of RL(z)f converge [15].
Preprint for review purposes only.
8
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
appropriately increase N too. In practice, we increase N by selecting it adaptively
to ensure that we adequately resolve solutions to (4.6) (see Figure 4.1 (left)). The
precise details on how we adequately resolve solutions are given in subsection 6.2.
4.2. Pointwise convergence of smoothed measure. It is known that if
Âµf is locally absolutely continuous with continuous Radonâ€“Nikodym derivative Ïf
(see (2.2)), then ÂµÏµ
f converges pointwise to Ïf [52, p. 22]. However, under additional
smoothness assumptions on Âµf, it is useful to understand how rapidly ÂµÏµ
f converges to
Âµf. The connection between ÂµÏµ
f and the Poisson kernel in (4.3) allows us to do this on
intervals for which Âµf possesses some local regularity so that Ïf is HÂ¨older continuous.
We let Ck,Î±(I) denote the HÂ¨older space of functions that are k times continuously
diï¬€erentiable on an interval I with an Î±-HÂ¨older continuous kth derivative [36]. For
h1 âˆˆC0,Î±(I) and h2 âˆˆCk,Î±(I) we deï¬ne the seminorm and norm, respectively, as
|h1|C0,Î±(I) = sup
xÌ¸=yâˆˆI
|h1(x) âˆ’h1(y)|
|x âˆ’y|Î±
,
âˆ¥h2âˆ¥Ck,Î±(I) = |h(k)
2 |C0,Î±(I) + max
0â‰¤jâ‰¤k âˆ¥h(j)
2 âˆ¥âˆ,I.
Theorem 4.1. Suppose that the measure Âµf in (2.2) is absolutely continuous on
the interval I = (x0 âˆ’Î·, x0 + Î·) for some x0 âˆˆR and Î· > 0, let ÂµÏµ
f be deï¬ned as
in (4.5), and let 0 â‰¤Î± < 1. If Ïf âˆˆC0,Î±(I), then
|Ïf(x0) âˆ’ÂµÏµ
f(x0)| = O(ÏµÎ±),
as
Ïµ â†“0.
Proof. First, decompose Ïf into two non-negative parts so that Ïf = Ï1 + Ï2,
where the support of Ï1 is in I and Ï2 vanishes on (x0 âˆ’Î·/2, x0 + Î·/2).
Since
Ïf(x0) = Ï1(x0) and the Poisson kernel integrates to 1, we can use the convolution
representation for ÂµÏµ
f (see (4.3) and (4.5)) and the commutativity of convolution to
bound the approximation error as
(4.8)
Ï€|Ïf(x0) âˆ’ÂµÏµ
f(x0)| =

Z
R
Ïµ
Ïµ2 + y2 Ï1(x0)dy âˆ’
Z
R
ÏµdÂµf(y)
Ïµ2 + (x0 âˆ’y)2

â‰¤

Z
R
Ïµ
Ïµ2 + y2 (Ï1(x0) âˆ’Ï1(x0 âˆ’y))dy
 +
Z
R
ÏµdÂµ(r)
f (y)
Ïµ2 + (x0 âˆ’y)2 .
Here, dÂµ(r)
f (y) := dÂµf(y) âˆ’Ï1(y)dy is a non-negative measure with support in R\(x0âˆ’
Î·/2, x0 + Î·/2). Since Âµf is a probability measure, we have that
R
R dÂµ(r)
f (y) â‰¤1, and
the second term in (4.8) is bounded via
(4.9)
Z
R
ÏµdÂµ(r)
f (y)
Ïµ2 + (x0 âˆ’y)2 =
Z
|x0âˆ’y|â‰¥Î·/2
ÏµdÂµ(r)
f (y)
Ïµ2 + (x0 âˆ’y)2 â‰¤
Ïµ
Ïµ2 + Î·2
4
.
Since Ïf âˆˆC0,Î±(I), standard arguments using cutoï¬€functions [36] show that we can
choose Ï1 so that |Ï1|C0,Î±(I) â‰¤|Ïf|C0,Î±(I) + CÎ·âˆ’Î±âˆ¥Ïfâˆ¥âˆ,I for some universal constant
C. Consequently, we have that
|Ï1(x0) âˆ’Ï1(x0 âˆ’y)| â‰¤|Ï1|C0,Î±(I)|y|Î± â‰¤(|Ïf|C0,Î±(I) + CÎ·âˆ’Î±âˆ¥Ïfâˆ¥âˆ,I)|y|Î±.
Substituting this bound into the ï¬rst term on the right-hand side of (4.8) and com-
bining with (4.9), yields
|Ïf(x0) âˆ’ÂµÏµ
f(x0)| â‰¤|Ïf|C0,Î±(I) + CÎ·âˆ’Î±âˆ¥Ïfâˆ¥âˆ,I
Ï€
Z
R
Ïµ
Ïµ2 + y2 |y|Î± dy +
Ïµ
Ï€

Ïµ2 + Î·2
4
.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
9
-1
-0.5
0
0.5
1
-60
-50
-40
-30
-20
-10
0
10
uÏµ(x)
x
-3
-2
-1
0
1
2
3
-5
0
5
uÏµ(Î¸)
Î¸
Figure 4.2. Real part of the numerical solutions to the shifted linear equations in (4.6) for
the integral operator in (4.7) (left) and the SchrÂ¨odinger operator in (4.11) (right), with Ïµ = 0.1
(yellow), Ïµ = 0.05 (orange), and Ïµ = 0.01 (blue). The solutions to (4.11) are mapped to [âˆ’Ï€, Ï€] via
x = 10i(1 âˆ’eiÎ¸)/(1 + eiÎ¸). We discretize using sparse, well-conditioned spectral methods and the
discretization sizes are selected adaptively to accurately resolve uÏµ(x) and uÏµ(Î¸).
Calculating the integral explicitly leads to
(4.10) |Ïf(x0) âˆ’ÂµÏµ
f(x0)| â‰¤
 |Ïf|C0,Î±(I) + CÎ·âˆ’Î±âˆ¥Ïfâˆ¥âˆ,I

sec
Î±Ï€
2

ÏµÎ± +
Ïµ
Ï€

Ïµ2 + Î·2
4
.
The right-hand side of (4.10) is O(ÏµÎ±) as Ïµ â†“0, which concludes the proof.
In Theorem 4.1, we see that the convergence rate of |Ïf(x0) âˆ’ÂµÏµ
f(x0)| as Ïµ â†“0
depends on the local regularity of Âµf. One can also show (see Theorem 5.2) that
|Ïf(x0) âˆ’ÂµÏµ
f(x0)| = O(Ïµ log(1/Ïµ)) if Ïf âˆˆC1(I) as well as the fact that any additional
smoothness assumptions on Ïf no longer improve the convergence rate.7 Since our
procedure is local, the convergence rate is not aï¬€ected by far away discrete and singular
continuous components of Âµf. However, the convergence degrades near singular points
in the spectral measure because the constants in (4.10) blow up as Î· â†’0. While
|Ïf(x0) âˆ’ÂµÏµ
f(x0)| = O(ÏµÎ±) in Theorem 4.1 is stated as an asymptotic statement, we
can also obtain explicit bounds for adaptive selection of Ïµ (see Theorem 5.2).
4.3. A numerical balancing act. To explore the practical importance of the
convergence rates in Theorem 4.1, we examine the numerical cost associated with
solving the shifted linear systems in (4.6). When the real component of the shift is in
the continuous spectrum of L and Ïµ is small, we typically require large discretizations
to avoid the situation observed in Figure 4.1 (right). There are many potential reasons
why we require large discretization sizes as Ïµ â†“0. Here are two illustrative examples:
1) Interior layers. Revisiting the integral operator example in (4.7), we select
x0 = 1/2 in the continuous spectrum of L, and f(x) =
p
3/2 x. In Figure 4.2 (left),
we observe that the solution uÏµ(x) develops an interior layer and blows up at x0 = 1/2
as Ïµ â†“0. The blow-up occurs because the multiplicative term in L âˆ’(x0 + iÏµ) has a
root at x0 = 1/2 when Ïµ = 0, giving rise to a pole in uÏµ(x). For Ïµ > 0, the pole of
uÏµ(x) is located at a distance of O(Ïµ) away from the real axis. A large discretization
size is needed to resolve uÏµ(x) for small Ïµ due to the thin interior layer in uÏµ(x).
7The logarithmic term occurs due to the non-integrability of x/(Ï€(x2 + 1)). One can also show
that the error rate of O(Ïµ log(1/Ïµ)) is achieved if Ïf âˆˆC0,1(I) is Lipschitz continuous.
Preprint for review purposes only.
10
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
0
1000
2000
3000
4000
10-15
10-10
10-5
100 |ÂµÏµ
f,N(x0) âˆ’ÂµÏµ
f(x0)|/|ÂµÏµ
f(x0)|
N
Ïµ = 0.05
Ïµ = 0.01
Ïµ = 0.005
10-2
10-1
100
10-2
10-1
100
|Ïf(x0) âˆ’ÂµÏµ
f(x0)|/|Ïf(x0)|
O(Ïµ log(Ïµâˆ’1))
Ïµ
Figure 4.3.
Left: The relative error in the numerical approximation ÂµÏµ
f,N, corresponding
to discretization size N, of the smoothed measure in (4.5) for the integral operator in (4.7) with
Ïµ = 0.05, Ïµ = 0.01, and Ïµ = 0.005. Right: The pointwise relative diï¬€erence between the smoothed
measure ÂµÏµ
f(x) and the density Ïf(x), evaluated at x0 = 1/2, compared with the O(Ïµ log(Ïµâˆ’1)) error
bound in Theorem 5.2 for the integral operator in (4.7). The relative error is computed by comparing
with a numerical solution that has been adaptively resolved to machine precision.
2) Oscillatory behavior. Consider the second-order diï¬€erential operator given by
(4.11)
[Lu](x) = âˆ’d2u
dx2 (x) +
x2
1 + x6 u(x),
x âˆˆR.
We select x0 = 0.3 in the continuous spectrum of L, and f(x) =
p
9/Ï€ Â· x2/(1 + x6).
In Figure 4.2 (right), we plot solutions mapped onto the domain [âˆ’Ï€, Ï€] by the change-
of-variables x = 10i(1 âˆ’eiÎ¸)/(1 + eiÎ¸). The solutions uÏµ(x) are highly oscillatory with
slow decay as Î¸ â†’Â±Ï€. As Ïµ â†“0 the decay degrades and the persistent oscillations
correspond to a transition in the nature of the singular points of (4.6) at Â±âˆ. This
means a large discretization is needed to resolve uÏµ(x) for small Ïµ.
The dominating computational expense in evaluating ÂµÏµ
f is solving the shifted
linear systems in (4.6), and the cost of computing uÏµ(x) generally increases as Ïµ â†“0.
There is a balancing act. On the one hand, we wish to stay as far away from the
spectrum as possible, so that the evaluation of ÂµÏµ
f is computationally eï¬ƒcient. On the
other hand, we desire samples of ÂµÏµ
f to be good approximations to Ïf, which requires
a small Ïµ > 0.
Even though we use sparse, well-conditioned spectral methods to
discretize (4.6) (see section 6), the trade-oï¬€between computational cost and accuracy
means that the slow convergence rate determined in Theorem 4.1 is a severe limitation.
In Figure 4.3, we explore the discretization sizes that are needed to evaluate spectral
measures with the Poisson kernel accurately. For the integral operator in (4.7) and Ïµ =
0.05, 0.01, and 0.005, we observe that we need N = 400, 1700, and 3100, respectively
(see Figure 4.3 (left)).
Unfortunately, to obtain samples of the spectral measure
with two digits of relative accuracy, we require that Ïµ â‰ˆ0.01 (see Figure 4.3). For this
example, we observe that we require N â‰ˆ20/Ïµ for small Ïµ > 0, so it is computationally
infeasible to obtain more than ï¬ve or six digits of accuracy with the Poisson kernel.
In addition to the computational cost of increasing N, the discretizations used to
solve the linear systems in (4.6) become increasingly ill-conditioned when x0 âˆˆÎ›(L)
and Ïµ â†“0 (a reï¬‚ection of âˆ¥RL(x0+iÏµ)âˆ¥= Ïµâˆ’1). This can limit the attainable accuracy.
Moreover, the performance of iterative methods, if used to accelerate the solution
of the large shifted linear systems, may also suï¬€er. In our experience, the cost of
increasing N is usually the limiting factor and we rarely take Ïµ < 10âˆ’2.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
11
5. High-order kernels.
Theorem 4.1 demonstrates that ÂµÏµ
f â†’Ïf pointwise
in intervals for which Âµf is absolutely continuous with HÂ¨older continuous density Ïf,
where the rate of convergence depends on the HÂ¨older exponent of Ïf. However, even
when Ïf possesses additional regularity, the best rate of convergence for smoothed
measures using the Poisson kernel is O(Ïµ log(1/Ïµ)). A natural question is:
â€œCan we use other kernels to exploit additional regularity in Âµf?â€
In this section, we construct kernels that can be used to compute smoothed mea-
sures that approximate Ïf to high-order in Ïµ when Ïf is smooth. This allows us to
obtain accurate samples of Âµf while avoiding extremely small Ïµ and the associated
computational cost of solving the shifted linear equations in (4.6) when the shifts are
close to the real line. We use K(x) to denote a kernel for which KÏµ(x) = Ïµâˆ’1K(x/Ïµ)
is an approximation to the identity, i.e., KÏµ â†’Î´ as Ïµ â†“0 in the sense of distribu-
tions [98, Ch. 3], where Î´ is the Dirac delta distribution.
To gain intuition about the conditions that K(x) must satisfy so that KÏµ âˆ—Âµf
approximates Âµf to high-order, consider an absolutely continuous probability measure
Âµ with density Ï supported on an interval I = (x0âˆ’Î·, x0+Î·), for some x0 âˆˆR and Î· >
0. The following argument is common in statistical non-parametric regression [115,
116]. Since we want KÏµ to be an approximation to the identity, our ï¬rst property is
that
R
R K(x)dx = 1. For further properties, we examine the approximation error
[KÏµ âˆ—Âµ](x0) âˆ’Ï(x0) =
Z
R
KÏµ(y)(Ï(x0 âˆ’y) âˆ’Ï(x0)) dy.
Assuming that Ï âˆˆCn,Î±(I) for some 0 < Î± < 1, we can use an nth order Taylor
expansion of Ï(x0 âˆ’y) âˆ’Ï(x0) to rewrite the approximation error as
[KÏµ âˆ—Âµ](x0) âˆ’Ï(x0) =
nâˆ’1
X
k=1
(âˆ’1)kÏ(k)(x0)
k!
Z
R
KÏµ(y)yk dy +
Z
R
KÏµ(y)Rn(x0, y) dy,
where Rn(x0, y) denotes the O(|y|n) remainder term in the Taylor series and Ï(k) is
the kth derivative of Ï. The change-of-variables y â†’Ïµy reveals that the kth term in
the series is of size O(Ïµk), provided that K(y)yk is integrable. Meanwhile, the HÂ¨older
continunity of Ï(n) shows that the term involving Rn(x0, y) is of size O(Ïµn+Î±) provided
that K(y)yn+Î± is integrable and
R
R K(y)yn dy = 0. Therefore, a kernel that achieves
an O(Ïµn+Î±) approximation error has vanishing moments, i.e.,
R
R K(y)yk dy = 0 for
1 â‰¤k â‰¤n.
In practice, Âµ may not be absolutely continuous and its absolutely continuous part
may have a density Ï with singular points or unbounded support. As in Theorem 4.1,
we can deal with the general case by decomposing Ï = Ï1 + Ï2 into two non-negative
parts, where Ï1 is suï¬ƒciently smooth and compactly supported on I, and where Ï2
vanishes in a neighborhood of x0. The cost of this decomposition is a second term in
the approximation error (analogous to the second term on the right-hand side of (4.8))
[KÏµ âˆ—Âµ](x0) âˆ’Ï(x0) =
Z
R
KÏµ(y)(Ï1(x0 âˆ’y) âˆ’Ï1(x0)) dy +
Z
R
KÏµ(x0 âˆ’y) dÂµ(r)(y),
where dÂµ(r)(y) = dÂµ(y) âˆ’Ï1(y)dy.
To ensure that this additional term does not
dominate as Ïµ â†“0, it is necessary that the kernel K(y) decays at an appropriate rate
as |y| â†’âˆ. This ensures that KÏµ(x0 âˆ’y) is suï¬ƒciently small on the support of
dÂµ(r)(y) (see (4.9) for the decay in the Poisson kernel). Motivated by this discussion,
we make the following deï¬nition (similar to [115, Def. 1.3]).
Preprint for review purposes only.
12
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
Definition 5.1 (mth order kernel). Let m be a positive integer and K âˆˆL1(R).
We say K is an mth order kernel if it satisï¬es the following properties:
(i) Normalized:
R
R K(x)dx = 1.
(ii) Zero moments: K(x)xj is integrable and
R
R K(x)xjdx = 0 for 0 < j < m.
(iii) Decay at Â±âˆ: There is a constant CK, independent of x, such that
(5.1)
|K(x)| â‰¤
CK
(1 + |x|)m+1 ,
x âˆˆR.
It is straightforward to verify that the Poisson kernel is a ï¬rst-order kernel and
the Gaussian kernel, i.e., h(x) = (2Ï€)âˆ’1/2eâˆ’x2/2, is a second-order kernel. While the
Gaussian kernel plays an important role in DOS calculations [69] and kernel density
estimation [93], it is not as useful in our framework since the evaluation of hÏµ âˆ—Âµf is
not immediately related to pointwise evaluations of the resolvent (see subsection 5.1).
Since an mth order kernel, K, is an approximation to the identity, one can show
that KÏµ âˆ—Âµf converges weakly to Âµf. Moreover, in intervals where Âµf is absolutely
continuous and suï¬ƒciently regular, KÏµ âˆ—Âµf converges pointwise to Ïf and the rate of
convergence increases with the smoothness of Ïf, up to a maximum of O(Ïµm log(1/Ïµ)).
Theorem 5.2. Let K be an mth order kernel and suppose that the measure Âµf
is absolutely continuous on I = (x0 âˆ’Î·, x0 + Î·) for Î· > 0 and a ï¬xed x0 âˆˆR.
Let Ïf be the Radonâ€“Nikodym derivative of the absolutely continuous component of
Âµf, and suppose that Ïf âˆˆCn,Î±(I) with Î± âˆˆ[0, 1). Denote the pointwise error by
EÏµ(x) = |Ïf(x) âˆ’[KÏµ âˆ—Âµf](x)|. Then it holds that
(i) If n + Î± < m, then, for a constant C(n, Î±) depending only on n and Î±,
(5.2) EÏµ(x0)â‰¤
CKÏµm
(Ïµ + Î·
2)m+1 +C(n, Î±)âˆ¥Ïfâˆ¥Cn,Î±(I)
Z
R
|K(y)||y|n+Î±dy
 1 + Î·âˆ’nâˆ’Î±
Ïµn+Î±.
(ii) If n + Î± â‰¥m, then, for a constant C(m) depending only on m,
(5.3) EÏµ(x0)â‰¤
CKÏµm
(Ïµ + Î·
2)m+1 + C(m)âˆ¥Ïfâˆ¥Cm(I)
 
CK +
Z
Î·
Ïµ
âˆ’Î·
Ïµ
|K(y)||y|mdy
!
 1 + Î·âˆ’m
Ïµm.
Here, CK is from (5.1).
Proof. See Appendix A.1.
Using (5.1) to bound |K(y)| in (5.2) and (5.3), Theorem 5.2 shows that, under
local regularity conditions near x0 âˆˆR and for ï¬xed Î· > 0, an mth order kernel has
|Ïf(x0) âˆ’[KÏµ âˆ—Âµf](x0)| = O(Ïµn+Î±) + O(Ïµm log(1/Ïµ)),
as
Ïµ â†“0.
The logarithmic term appears in the case that K(x)xm is not integrable. The upper
bounds on EÏµ(x0) in Theorem 5.2 deteriorate as the interval of regularity shrinks
(Î· â†’0), which is to be expected.8
5.1. Rational kernels. Now that we know the necessary properties of a kernel
K so that KÏµ âˆ—Âµf achieves high-order convergence (see Deï¬nition 5.1), we can de-
velop a resolvent-based approach to approximately evaluate a spectral measure more
8Similar results to Theorem 5.2, without the ï¬rst term on the right-hand side of (5.2) and (5.3),
for absolutely continuous probability measures with globally HÂ¨older continuous density functions are
used in kernel density estimation in statistics (see, for example, [115, Prop. 1.2]).
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
13
eï¬ƒciently. The key to our computational framework (see section 4) is the connection
between the smoothed measure and the resolvent in (4.3). This relation allows us to
compute the convolution of the measure Âµf with the Poisson kernel by evaluating the
resolvent operator at the poles of the (rescaled) Poisson kernel. In other words, we
can sample the smoothed measure by solving the shifted linear equations in (4.6).
Using the identity in (4.2), we can build generalizations of (4.3) for convolutions
with rational functions. Suppose that the kernel K is of the form
(5.4)
K(x) =
1
2Ï€i
n1
X
j=1
Î±j
x âˆ’aj
âˆ’
1
2Ï€i
n2
X
j=1
Î²j
x âˆ’bj
,
where a1, . . . , an1 are distinct points in the upper half-plane and b1, . . . , bn2 are distinct
points in the lower half-plane. We restrict K to have only simple poles to avoid having
to compute powers of the resolvent. Using (4.2), the convolution KÏµ âˆ—Âµf is given by
(5.5)
[KÏµ âˆ—Âµf](x) = âˆ’1
2Ï€i
ï£®
ï£°
n1
X
j=1
Î±jâŸ¨RL(x âˆ’Ïµaj)f, fâŸ©âˆ’
n2
X
j=1
Î²jâŸ¨RL(x âˆ’Ïµbj)f, fâŸ©
ï£¹
ï£».
Our goal is to choose the poles and residues in (5.4) so that K is an mth order kernel.
Given an integer m â‰¥1, we are interested in ï¬nding the smallest possible n1 and n2
in (5.4) so that (5.5) is as eï¬ƒcient to evaluate as possible.
We want K(x) = O(|x|âˆ’(m+1)) as |x| â†’âˆ, which forces linear constraints to
hold between the Î±1, . . . , Î±n2 and Î²1, . . . , Î²n2 parameters, as follows. Generically, K
in (5.4) is a type (n1+n2âˆ’1, n1+n2) rational function, which means it can be written
as the quotient of a degree n1 + n2 âˆ’1 polynomial and a degree n1 + n2 polynomial.
In this form, the coeï¬ƒcient of highest power of x in the numerator is a multiple of
n1
X
j=1
Î±j âˆ’
n2
X
j=1
Î²j,
which must vanish for K to have suï¬ƒcient decay. Under this condition, we ï¬nd that
K(x)x =
1
2Ï€i
n1
X
j=1
Î±jaj
x âˆ’aj
âˆ’
1
2Ï€i
n2
X
j=1
Î²jbj
x âˆ’bj
.
We can apply the same argument as before to see that when m â‰¥2, we require that
n1
X
j=1
Î±jaj âˆ’
n2
X
j=1
Î²jbj = 0.
We repeat this process m âˆ’1 times (each time multiplying each term in the sum by
the appropriate aj or bj) to ï¬nd that K(x) = O(|x|âˆ’(m+1)) as |x| â†’âˆif and only if
(5.6)
n1
X
j=1
Î±jak
j =
n2
X
j=1
Î²jbk
j ,
k = 0, . . . , m âˆ’1.
Assuming (5.6) is satisï¬ed, the normalization and zero moment conditions (see Def-
inition 5.1 (i) and (ii)) provide us with m linear conditions on the moments of K,
which can be computed explicitly via contour integration. Employing a semi-circle
Preprint for review purposes only.
14
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
m
Ï€K(x) Qm
j=1(x âˆ’aj)(x âˆ’aj)
{Î±1, . . . , Î±âŒˆm/2âŒ‰}
2
20
9
 1+3i
2
	
3
âˆ’5
4x2 + 65
16
{âˆ’2 + i, 5}
4
âˆ’3536
625 x2 + 21216
3125
 âˆ’39âˆ’65i
24
, 17+85i
8
	
5
130
81 x4 âˆ’12350
729 x2 + 70720
6561
 15âˆ’10i
4
, âˆ’39+13i
2
, 65
2
	
6
1287600
117649 x4 âˆ’34336000
823543 x2 + 667835200
40353607
 725+1015i
192
, âˆ’2775âˆ’6475i
192
, 1073+7511i
96
	
Table 5.1
The numerators and residues of the ï¬rst six rational kernels with equispaced poles (see (5.8)).
We give the ï¬rst âŒˆm/2âŒ‰residues because the others follow by the symmetry Î±m+1âˆ’j = Î±j.
contour in the upper half-plane, applying Cauchyâ€™s residue theorem, and taking the
radius of the semi-circle to inï¬nity, we ï¬nd that the moments are given in terms of
the poles and residues of K, i.e.,
Z
R
K(y)yk dy =
n1
X
j=1
Î±jak
j =
n2
X
j=1
Î²jbk
j ,
k = 0, . . . , m âˆ’1,
where the second equality follows from (5.6) or closing the contour in the lower half-
plane. Therefore, the rational kernel in (5.4) is an mth order kernel provided that the
following (transposed) Vandermonde systems are satisï¬ed:
(5.7)
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1
. . .
1
a1
. . .
an1
...
...
...
amâˆ’1
1
. . .
amâˆ’1
n1
ï£¶
ï£·
ï£·
ï£·
ï£¸
ï£«
ï£¬
ï£¬
ï£¬
ï£­
Î±1
Î±2
...
Î±n1
ï£¶
ï£·
ï£·
ï£·
ï£¸=
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1
. . .
1
b1
. . .
bn2
...
...
...
bmâˆ’1
1
. . .
bmâˆ’1
n2
ï£¶
ï£·
ï£·
ï£·
ï£¸
ï£«
ï£¬
ï£¬
ï£¬
ï£­
Î²1
Î²2
...
Î²n2
ï£¶
ï£·
ï£·
ï£·
ï£¸=
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1
0
...
0
ï£¶
ï£·
ï£·
ï£·
ï£¸.
The systems in (5.7) are guaranteed to have solutions when n1, n2 â‰¥m. For compu-
tational eï¬ƒciency, we select n1 = n2 = m poles in the upper and lower half-planes.
The Poisson kernel ï¬ts into this setting with m = 1, a1 = b1 = i and Î±1 = Î²1 = 1.
It may appear from (5.5) that we need 2m resolvent evaluations to evaluate KÏµâˆ—Âµf
at a single point x. However, if the poles are selected so that bj = aj and Î²j = Î±j, then
the conjugate symmetry of the resolvent, i.e., âŸ¨RL(Â¯z)f, fâŸ©= âŸ¨RL(z)f, fâŸ©, reduces the
number of resolvent evaluations to m. With this choice, we ï¬nd that
[KÏµ âˆ—Âµf](x) = âˆ’1
Ï€
m
X
j=1
Im (Î±j âŸ¨RL(x âˆ’Ïµaj)f, fâŸ©) ,
which is analogous to (4.5). While the properties of an mth order kernel determine
the number of poles and the residues of K (see (5.7)), the locations of the poles in
the upper half-plane are left to our discretion.
5.1.1. Equispaced poles. As a natural extension of the Poisson kernel, whose
two poles are at Â±i, we consider the family of mth order kernels with equispaced poles
in the upper and lower half-planes given by
(5.8)
aj =
2j
m + 1 âˆ’1 + i,
bj = aj,
1 â‰¤j â‰¤m.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
15
-4
-2
0
2
4
0
0.5
1
1.5
K(x)
x
m = 1

m = 2
-
m = 3

m = 4
-
m = 5

m = 6
-
10-2
10-1
100
10-10
10-5
100|Ïf(x0) âˆ’[KÏµ âˆ—Âµf](x0)|/|Ïf(x0)|
Ïµ
m = 1
m = 2
m = 3
m = 4 m = 5
m = 6
Figure 5.1. Left: The mth order kernels constructed from (5.7) with poles in (5.8) for 1 â‰¤
m â‰¤6. Right: The pointwise relative error in smoothed measures of the integral operator in (4.7)
computed using the high-order kernels with poles in (5.8) for 1 â‰¤m â‰¤6.
The relative error is
computed by comparing with a numerical solution that is resolved to machine precision.
0
1
2
3
4
5
6
10-6
10-4
10-2
100
[KÏµ âˆ—Âµf](x)
x
m = 1
m = 2




m = 6
10-2
10-1
100
10-10
10-8
10-6
10-4
10-2
100|Ïf(x0) âˆ’[KÏµ âˆ—Âµf](x0)|/|Ïf(x0)|
Ïµ
m = 1
m = 2
m = 3
m = 4
m = 5
m = 6
Figure 5.2. Results for the SchrÂ¨odinger operator in (4.11) using mth order kernels with equi-
spaced poles (see (5.8)). Left: Smoothed approximations to the spectral measure. Right: Pointwise
relative error, computed by comparing with a numerical solution resolved to machine precision.
We then determine the residues by solving the Vandermonde system in (5.7). The ï¬rst
six kernels are plotted in Figure 5.1 (left) and are explicitly written down in Table 5.1.
Empirically, we found that the choice in (5.8) performed slightly better than other
natural choices such as Chebyshev points with an oï¬€set +i, rotated roots of unity or
dyadic poles aj = i2âˆ’j. Dyadic poles have the advantage that if Ïµ is halved, the
resolvent only needs to be computed at one additional point. The ill-conditioning
of the Vandermonde system did not play a role for the values of m here. Moreover,
equispaced poles are particularly useful when one wishes to sample the smoothed
measure KÏµ âˆ—Âµf over an interval since samples of the resolvent can be reused for
diï¬€erent points in the interval. Finally, if Ïµ is found to be insuï¬ƒciently small, instead
of re-evaluating the resolvent at m points, one can add poles closer to the real axis
(with a smaller Ïµ) and reuse the old resolvent evaluations. This eï¬€ectively increases m,
and hence the coeï¬ƒcients Î±j need to be recomputed. This may be computationally
beneï¬cial since the cost of solving the Vandermonde system is typically negligible
compared to the cost of evaluating the resolvent close to the real axis.
To demonstrate the practical advantage of high-order kernels, we revisit the ex-
amples from section 4 and compute the smoothed measure KÏµ âˆ—Âµf using mth order
Preprint for review purposes only.
16
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
0.3
0.4
0.5
0.6
0.7
-1000
-800
-600
-400
-200
0
200
x
-3
-2
-1
0
1
2
3
-5
0
5
Î¸
Figure 5.3. Real part of Pm
j=1 Î²jRL(x âˆ’Ïµbj)f, where Ïµ is chosen to achieve a relative error
of 0.0001 for the integral operator in (4.7) (left) and 0.005 for the SchrÂ¨odinger operator in (4.11)
(right), with m = 1 (blue), m = 2 (yellow), m = 3 (orange), and m = 4 (purple). Recall that the
solutions to (4.11) are mapped to [âˆ’Ï€, Ï€] via x = 10i(1 âˆ’eiÎ¸)/(1 + eiÎ¸).
kernels with equispaced poles. In Figure 5.1 (right) and Figure 5.2 (right), we observe
the convergence rates predicted in Theorem 5.2 for the integral operator in (4.7) and
the diï¬€erential operator in (4.11), respectively. While the Poisson kernel requires us
to solve linear equations with shifts extremely close to the continuous spectrum to
achieve a few digits of accuracy in our approximation to Ïf, a sixth-order kernel en-
ables us to achieve about 11 and 9 digits of accuracy, respectively, without decreasing Ïµ
below 0.01. Figure 5.2 (left) shows the increased resolution obtained when using high-
order kernels for the diï¬€erential operator in (4.11) with smoothing parameter Ïµ = 0.1.
Although using a sixth-order kernel requires six times as many resolvent evaluations
as that of the Poisson kernel, this is typically favorable because the cost of evaluating
the resolvent near the continuous spectrum of L increases as Ïµ â†“0 (see subsection 4.3).
In Figure 5.3 (which should be compared to Figure 4.2), we plot the real part of
the linear combination of solutions, given by
Re
ï£«
ï£­
m
X
j=1
Î²jRL(x âˆ’Ïµbj)f
ï£¶
ï£¸.
Here, Ïµ is selected to achieve a relative error of 0.0001 and 0.005 in the density of
the integral and SchrÂ¨odinger operators, respectively. For a ï¬xed relative error, the
high-order kernels lead to numerical solutions that are less peaked (or less oscillatory),
which allows us to use much smaller discretizations of the linear operators.
5.2. Other types of convergence. Consider the radial SchrÂ¨odinger operator
with a Hellmann potential and angular momentum quantum number â„“, given by [50]
(5.9)
[Lu](r) = âˆ’d2u
dr2 (r) +
â„“(â„“+ 1)
r2
+ 1
r (eâˆ’r âˆ’1)

u(r),
r > 0.
The spectral properties of L are of interest in quantum chemistry, where the Hellman
potential models atomic and molecular ionization processes [48]. Ionization rates and
related transition probabilities are usually studied by computing bound and resonant
states of L; however, we compute this information directly from the spectral measure.
For example, if f(r) = Ceâˆ’(râˆ’r0)2 (where C is chosen so that âˆ¥fâˆ¥L2(R+) = 1) is
the radial component of the wave function of an electron interacting with an atomic
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
17
[KÏµ âˆ—Âµf](x)
x
r0 = 4
r0 = 3
r0 = 2
10-2
10-1
100
10-8
10-6
10-4
10-2
100
âˆ¥Ïf âˆ’[KÏµ âˆ—Âµf]âˆ¥L1/âˆ¥Ïfâˆ¥L1
m = 1
m = 2
m = 3
m = 4
Ïµ
Figure 5.4. Left: The smoothed approximation to the density on the absolutely continuous
spectrum of L in (5.9), with fr0(r) = Cr0eâˆ’(râˆ’r0)2 and â„“= 1, for r0 = 2, r0 = 3, and r0 = 4 (Cr0
is a normalization constant so that âˆ¥fr0âˆ¥L2(R+) = 1). The shaded area under each curve corresponds
to P(1/2 â‰¤E â‰¤2) in (5.10) for the particle with wave function fr0(r). Right: The L1((1/2, 2))
relative error in smoothed measures for the radial SchrÂ¨odinger operator in (5.9). The relative error
is computed by comparing with a numerical solution that is resolved to machine precision.
core via the Hellmann potential in (5.9), then we can calculate the probability that
the electron escapes from the atomic core with energy E âˆˆ[a, b] (with 0 < a < b) via
(5.10)
P(a â‰¤E â‰¤b) = Âµf([a, b]) â‰ˆ
Z b
a
[KÏµ âˆ—Âµf](y) dy,
Ïµ â‰ª1.
The error for the approximation in (5.10) is bounded above by
Âµf([a, b]) âˆ’
Z b
a
[KÏµ âˆ—Âµf](y) dy
 â‰¤
Z b
a
|Ïf(y)âˆ’[KÏµâˆ—Âµf](y)| dy = âˆ¥Ïf âˆ’KÏµâˆ—Âµfâˆ¥L1([a,b]).
This leads us naturally to the notion of Lp convergence on an interval. The smoothed
measure always converges to Ïf in L1([a, b]) when Âµf is absolutely continuous on [a, b].
However, in analogy with the pointwise results in subsection 4.2 and section 5, we
need to impose some additional regularity on Ïf to obtain rates of convergence. We
let Wk,p(I) denote the Sobolev space of functions in Lp(I) such that f and its weak
derivatives up to order k have a ï¬nite Lp norm [36].
Theorem 5.3. Let K be an mth order kernel and 1 â‰¤p < âˆ. Suppose that the
measure Âµf is absolutely continuous on the interval I = (a âˆ’Î·, b + Î·) for Î· > 0 and
some a < b. Let Ïf denote the Radonâ€“Nikodym derivative of the absolutely continuous
component of Âµf, and suppose that ÏI := Ïf|I âˆˆWm,p(I). Then,
âˆ¥ÏI âˆ’[KÏµ âˆ—Âµf]âˆ¥Lp((a,b)) â‰¤CK(b âˆ’a)1/p
 Ïµ + Î·
2
m+1 Ïµm
+ C(m)CKâˆ¥ÏIâˆ¥Wk,p(I)
 1 + Î·âˆ’m
log

1 + b âˆ’a + 2Î·
Ïµ

Ïµm,
where C(m) is a constant depending only on m, and CK is from (5.1).
Proof. See Appendix A.2.
Preprint for review purposes only.
18
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
Theorem 5.3 implies the asymptotic error rate9
âˆ¥ÏI âˆ’[KÏµ âˆ—Âµf]âˆ¥Lp(I) = O(Ïµm log(1/Ïµ)),
as
Ïµ â†“0.
The L1 convergence for the approximation to the probabilities in (5.10) is shown
in Figure 5.4 (right), which agrees with the asymptotic rates implied by Theorem 5.3.
If one wishes to compute dynamics of the electron interacting with the atomic core
via the Hellman potential, then we need a slightly weaker form of convergence. For
instance, the time autocorrelation of the electronâ€™s wave function can be computed
by integrating the function Ft(E) = eâˆ’iEt against the measure Âµf, so that
Âµf(Ft) = âŸ¨eâˆ’iLtf, fâŸ©=
Z âˆ
âˆ’âˆ
eâˆ’iyt dÂµf(y) â‰ˆ
Z âˆ
âˆ’âˆ
eâˆ’iyt [KÏµ âˆ—Âµf](y) dy,
Ïµ â‰ª1.
Unlike the previous cases of pointwise and L1 convergence, we do not need any ad-
ditional requirements on the measure Âµf, which may be singular and have discrete
components, to obtain convergence rates. Instead, we require that the function F be
suï¬ƒciently smooth. For example, if F âˆˆCn,Î±(R) and K is an mth order kernel, then
approximating F via convolutions and applying Fubiniâ€™s theorem shows that
|Âµf(F) âˆ’[KÏµ âˆ—Âµf](F)| = O(Ïµn+Î±) + O(Ïµm log(1/Ïµ)),
as
Ïµ â†“0.
Finally, note that a kernel cannot be non-negative everywhere and have an order
greater than two. This is not a problem in practice since we can replace [KÏµ âˆ—Âµf](x)
by max{0, [KÏµ âˆ—Âµf](x)} with the same error bounds in Theorems 5.2 and 5.3.
6. The resolvent framework in practice. Given an mth order rational ker-
nel, deï¬ned by distinct poles a1, . . . , am in the upper half-plane, the resolvent-based
framework for evaluating an approximate spectral measure is summarized in Algo-
rithm 6.1. This algorithm, which can be performed in parallel for several x0, forms
the foundation of SpecSolve. SpecSolve uses equispaced poles (see subsection 5.1.1)
by default, but users may select other options with the name-value pair â€˜PoleTypeâ€™.
In practice, the resolvent in Algorithm 6.1 is discretized before being applied. We
compute an accurate value of ÂµÏµ
f provided that the resolvent is applied with suï¬ƒ-
cient accuracy (see Figure 4.1), which can be done adaptively with a posteriori error
bounds [15]. For an eï¬ƒcient adaptive implementation, SpecSolve constructs a ï¬xed
discretization, solves linear systems at each required complex shift, and checks the ap-
proximation error at each shift. If further accuracy is needed at a subset of the shifts,
then the discretization is reï¬ned geometrically, applied at these shifts, and the error
is recomputed. This process is repeated until the resolvent is computed accurately at
all shifts. The user may (optionally) specify initial and maximum discretization sizes
with the name-value pairs â€˜DiscMinâ€™ and â€˜DiscMaxâ€™.
SpecSolve supports three types of operators: (1) ordinary diï¬€erential opera-
tors, (2) integral operators, and (3) inï¬nite matrices with ï¬nitely many non-zeros
per column. For more general operators and inner products, the user must supply a
command that solves the shifted linear equations in Algorithm 6.1 and a command
that evaluates the inner products, allowing a user to evaluate spectral measures for
exotic problems and employ their favorite discretization.
9Theorem 5.3 for p = 2 without the ï¬rst term on the right-hand side and for absolutely con-
tinuous probability measures with Wm,2(R) density function is used in kernel density estimation in
statistics [115, Prop. 1.5]. In this context, the L2 error is used to bound the bias term in the mean
integrated squared error. The case of L1 convergence requires a diï¬€erent proof technique.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
19
Algorithm 6.1 A practical framework for evaluating an approximate spectral mea-
sure of an operator L at x0 âˆˆR with respect to a vector f âˆˆH.
Input: L : D(L) â†’H, f âˆˆH, x0 âˆˆR, a1, . . . , am âˆˆ{z âˆˆC : Im(z) > 0}, and Ïµ > 0.
1: Solve the Vandermonde system (5.7) for the residues Î±1, . . . , Î±m âˆˆC.
2: Solve (L âˆ’(x0 âˆ’Ïµaj))uÏµ
j = f for 1 â‰¤j â‰¤m.
3: Compute ÂµÏµ
f(x0) = âˆ’1
Ï€ Im
Pm
j=1 Î±jâŸ¨uÏµ
j, fâŸ©

.
Output: ÂµÏµ
f(x0).
6.1. Ordinary diï¬€erential operators. As part of its capabilities, SpecSolve
computes samples from a smoothed approximation to the spectral measure of a self-
adjoint, regular ordinary diï¬€erential operator on the real-line or on the half-line, i.e.,
(6.1)
[Lu](x) = cp(x)dpu
dxp (x) + Â· Â· Â· + c1(x)du
dx(x) + c0(x)u(x),
p â‰¥0,
with the standard inner products. Here, the variable coeï¬ƒcients c0, . . . , cp are smooth
functions and cp Ì¸= 0 on the relevant domain (real-line or half-line).
Note that
L in (6.1) is not necessarily self-adjoint: the user provides the variable coeï¬ƒcients
c0, . . . , cp and must verify that L is self-adjoint.
To demonstrate, recall the SchrÂ¨odinger operator deï¬ned on the real line in (4.11).
We can compute a smoothed approximation to its spectral measure using the function
diffMeas as follows.
xi = linspace(0,6,121);
% Evaluation pts
f = @(x) x.^2./(1+x.^6) * sqrt(9/pi);
% Measure wrt f(x)
c = {@(x) x.^2./(1+x.^6), @(x) 0, @(x) -1};
% Schrodinger op
mu = diffMeas(c, f, xi, 0.1, â€˜orderâ€™, 1);
% epsilon=0.1, m=1
The diï¬€erential operator is speciï¬ed by its coeï¬ƒcients c0, . . . , c2, which are input as
a cell array of function handles. Given evaluation points xi and function handle f,
diffMeas computes the smoothed measure, with respect to f, using the speciï¬ed
smoothing parameter and kernel order (the default kernel is m = 2).
To apply the resolvent of a diï¬€erential operator acting on functions on the real
line, the associated diï¬€erential equation (see Algorithm 6.1) is automatically trans-
planted to the periodic interval [âˆ’Ï€, Ï€] with an analytic map and solved with an
adaptive Fourier spectral method [9]. Typically, the diï¬€erential equation has singular
points at Â±Ï€ after mapping, and the Fourier spectral method usually converges to
a bounded analytic solution [9, Ch. 17.8]. Similarly, on the half-line, the diï¬€erential
equation is mapped to the unit interval [âˆ’1, 1] with an analytic map and solved with
an adaptive nonperiodic analogue of the Fourier spectral method known as the ultra-
spherical spectral method [77]. After solving the diï¬€erential equation on the mapped
domain, the inner products in (4.5) are computed using a trapezoidal rule (for the
unit circle) [113] or a Clenshawâ€“Curtis rule (for the unit interval) [111, Ch. 19].
In many applications, diï¬€erential operators on the half-line may have a singular
point at the origin. This makes an eï¬ƒcient and automatic representation of variable
coeï¬ƒcients somewhat subtle. For example, the radial SchrÂ¨odinger operator in (5.9)
has a singular point at the origin for â„“â‰¥1, and the shifted linear equations in Algo-
rithm 6.1 should be multiplied through by r2 so that subsequent discretizations yield
sparse, banded matrices [77]. In addition to diffMeas, SpecSolve contains a small
gallery of functions that sample smoothed spectral measures for common operators
with singular points, such as rseMeas, which samples the smoothed measure of the
Preprint for review purposes only.
20
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
radial SchrÂ¨odinger operator with a user-speciï¬ed potential.
To illustrate, we use rseMeas to compute P(1/2 â‰¤E â‰¤2) from (5.10).
normf = sqrt(pi/8)*(2-igamma(1/2,8)/gamma(1/2)); % Normalization
f = @(r) exp(-(r-2).^2)/sqrt(normf);
% Measure wrt f(r)
V={@(r) 0, @(r) exp(-r)-1, 1};
% Potential, l=1
[xi, wi] = chebpts(20,
[1/2 2]);
% Quadrature rule
mu = rseMeas(V, f, xi, 0.1, â€˜Orderâ€™, 4)
% epsilon=0.1, m=4
ion_prob = wi * mu;
% Ionization prob
The user speciï¬es the potential of the radial SchrÂ¨odinger operator through a cell array
of function handles: V{1} is the nonsingular part of the potential, V{2} is the variable
coeï¬ƒcient for the râˆ’1 Coulomb term, and V{3} is the quantum angular momentum
number that deï¬nes the coeï¬ƒcient for the râˆ’2 centrifugal term.
6.2. Integral operators. In SpecSolve, the function intMeas computes sam-
ples from a smoothed approximation of the spectral measure of an integral operator,
acting on functions deï¬ned on [âˆ’1, 1], of the form
[Lu](x) = a(x)u(x) +
Z 1
âˆ’1
g(x, y) u(y) dy,
x âˆˆ[âˆ’1, 1],
u âˆˆL2([âˆ’1, 1]).
We assume that the multiplicative coeï¬ƒcient a(x) and the kernel g(x, y) are smooth
functions (well-approximated by polynomials), and that g(x, y) = g(y, x) so that L is
self-adjoint with respect to the standard inner product. Revisiting the integral opera-
tor from (4.7), we can compute the smoothed measure with a few simple commands.
xi = linspace(-2.5,2.5,501);
% Evaluation pts
f = @(x) sqrt( 3/2 ) * x;
% Measure wrt f(x)
a = { @(x) x, @(x,y) exp(-(x.^2+y.^2)) };
% Integral operator
mu = intMeas(a, f, xi, 0.1, â€˜Orderâ€™, 1);
% epsilon=0.1, m=1
The integral operator is speciï¬ed by a cell array containing function handles for the
kernel and multiplicative coeï¬ƒcient. Given smoothing parameter and kernel order,
the smoothed measure is approximated at the evaluation points xi.
To apply the resolvent, we use an adaptive Chebyshev collocation scheme to solve
the shifted linear systems in Algorithm 6.1. For eï¬ƒcient storage and computation, we
exploit low numerical rank structure in the discretization of the smooth kernels when
possible [110]. We apply a Clenshawâ€“Curtis quadrature rule to compute the inner
products required to sample ÂµÏµ
f [111].
6.3. Inï¬nite sparse matrices. In SpecSolve, the function infmatMeas deals
with discrete systems. We consider the canonical Hilbert space â„“2(N) (with the stan-
dard inner product) and assume that L is realized as an inï¬nite matrix A such that
A =
ï£«
ï£¬
ï£­
a11
a12
. . .
a21
a22
. . .
...
...
...
ï£¶
ï£·
ï£¸,
aij = âŸ¨Lej, eiâŸ©= aji,
where ei is the ith canonical unit vector. We assume that the span of the canonical
basis forms a core10 of L and that there is known function F : N â†’N such that
aij = 0 if i > F(j).11 There is no loss of generality in working in â„“2(N) since we can
10This technical condition means that the closure of L restricted to the span of the canonical basis
is L, and hence we can equate L with the inï¬nite matrix A.
11Weaker assumptions such as known asymptotic decay of each column are also possible.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
21
always choose an orthonormal basis of a separable Hilbert space to obtain H âˆ¼= â„“2(N).
The majority of graph operators that are encountered in physics can be put in this
framework. For example, given a ï¬nite range interaction Hamiltonian on â„“2(Zd), one
can enumerate the vertices of the graph to obtain a realization of â„“2(Zd) âˆ¼= â„“2(N) as
well as an associated function F. The value of [KÏµ âˆ—Âµf](x0) for some f âˆˆâ„“2(N) is
then approximated through least-squares solutions of the rectangular systems [15]
PF (N)(A âˆ’(x0 + Ïµaj))PNuÏµ
j = PF (N)f,
where Pn denotes the orthogonal projection onto the span of the ï¬rst n basis vectors.
For a rectangular truncation H = PF (N)APN supplied by the user, we can, for exam-
ple, compute the smoothed measure with respect to the ï¬rst canonical basis vector
via the following commands.
xi = linspace(-3.1,3.1,125);
% Evaluation pts
b = zeros(size(H,1),1); b(1) = 1;
% Measure wrt vector b
mu = infmatMeas(H,b,xi,0.05,â€˜Orderâ€™,2);
% epsilon=0.05, m=2
An example for a magnetic SchrÂ¨odinger equation on a graphene lattice (see subsec-
tion 7.2) is provided in the gallery of examples in SpecSolve.
7. Examples. We now provide three examples to demonstrate the versatility of
our computational framework.
7.1. Example 1:
Beam and two-dimensional SchrÂ¨odinger equations.
The increased computational eï¬ƒciency achieved through high-order kernels allows
us to treat PDEs and high-order ODEs. First, consider a fourth-order diï¬€erential
operator associated with the elastic beam equation, given by
(7.1)
[Lu](x) = d4u
dx4 (x) âˆ’d
dx

1 âˆ’eâˆ’x2 du
dx

(x) + a sin(x)
1 + x2 u(x),
x âˆˆR,
for some constant a âˆˆR. Figure 7.1 (left) shows KÏµ âˆ—Âµf, for a second-order kernel
with Ïµ = 0.05 and f(x) =
âˆš
2Ï€âˆ’1/(1 + x2), when a = 0, 5, and 10. When a = 0, the
operator is positive with continuous spectrum in [0, âˆ). When a Ì¸= 0, there is also an
eigenvalue below the continuous spectrum, corresponding to the spikes in Figure 7.1
(left). We also observe that diï¬€erent values of a alter the proï¬le of Ïf on [0, âˆ).
Next, consider the two-dimensional SchrÂ¨odinger operator given by
(7.2)
[Lu](x1, x2) = âˆ’âˆ‡2u(x1, x2) +
 
eâˆ’x2
1
1 + x2
2
+ a (erf(x1) + erf(x2))
!
u(x1, x2),
xj âˆˆR,
for some constant a âˆˆR, where erf(Â·) is the error function. To apply the resolvent
we map R2 to the torus [âˆ’Ï€, Ï€]2 via xj â†’10i(1 âˆ’eiÎ¸j)/(1 + eiÎ¸j). We then used a
tensorized Fourier spectral method with hyperbolic cross ordering of the basis func-
tions [71, Ch. III]. Figure 7.1 (right) shows KÏµ âˆ—Âµf, for a fourth-order kernel with
Ïµ = 0.2 and f(x1, x2) = exp(âˆ’x2
1 âˆ’x2
2)
âˆš
2Ï€âˆ’1, when a = 0, 1, and 2. The spectrum of
the operator is [âˆ’2a, âˆ) and we observe that the convolution [KÏµ âˆ—Âµf](x) takes small
negative values in the vicinity of the lower boundary of the spectrum.
7.2. Example 2: The SchrÂ¨odinger equation on a graphene lattice. We
now apply our method to a magnetic tight-binding model of graphene, which involves
a discrete graph operator [1]. Graphene is a two-dimensional material with carbon
atoms situated at the vertices of a honeycomb lattice (see Figure 7.2), whose unusual
Preprint for review purposes only.
22
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
-4
-2
0
2
4
6
10-6
10-4
10-2
100
[KÏµ âˆ—Âµf](x)
x
a = 10
a = 5
a = 0
-5
0
5
10
-0.05
0
0.05
0.1
0.15
0.2
0.25
0.3
-5
-4
-3
-2
-4
-2
0
10-5
@
@
I a = 0

a = 1
@@
R
a = 2
[KÏµ âˆ—Âµf](x)
x
Figure 7.1. Left: Smoothed approximations to the spectral measures of the elastic beam opera-
tors in (7.1) for a second-order kernel with a = 0, 5, and 10. Right: Smoothed approximations to the
spectral measures of the two-dimensional SchrÂ¨odinger operators in (7.2) for a fourth-order kernel
with a = 0, 1, and 2. The magniï¬ed region demonstrates that [KÏµ âˆ—Âµf](x) is not always positive for
kernels of order greater than two.
properties are studied in condensed-matter physics [75,76]. The magnetic properties of
graphene are important because of the experimental observation of the quantum Hall
eï¬€ect and Hofstadterâ€™s butterï¬‚y [82], and the exciting new area of twistronics [11,70].
7.2.1. The model. A honeycomb lattice can be decomposed into two bipartite
sub-lattices (see Figure 7.2 (left)) and thus, the wave function of an electron can be
modeled as the spinor [1]
Ïˆm,n = (Ïˆ[1]
m,n, Ïˆ[2]
m,n)T âˆˆC2,
Ïˆ = (Ïˆm,n) âˆˆl2(Z2; C2) âˆ¼= â„“2(N).
Here, (m, n) âˆˆZ2 labels a position on the sub-lattices and â„“2(Z2; C2) denotes the space
of square summable C2-valued sequences indexed by Z2. To deï¬ne the Hamiltonian,
consider the following three magnetic hopping operators T1, T2, T3 : â„“2(Z2; C2) â†’
â„“2(Z2; C2) for a given magnetic ï¬‚ux per unit cell Î¦ (in dimensionless units):
(T1Ïˆ)m,n =
 
Ïˆ[2]
m,n
Ïˆ[1]
m,n
!
,
(T2Ïˆ)m,n =
 
Ïˆ[2]
m+1,n
Ïˆ[1]
mâˆ’1,n
!
,
(T3Ïˆ)m,n =
 
eâˆ’2Ï€iÎ¦mÏˆ[2]
m,n+1
e2Ï€iÎ¦mÏˆ[1]
m,nâˆ’1
!
.
After a suitable gauge transformation, the free Hamiltonian can be expressed as H0 =
T1 + T2 + T3 and Î›(H0) âŠ‚[âˆ’3, 3]. A suitable ordering of lattice points leads to a
sparse discretization of H0, where the kth column contains O(
âˆš
k) non-zero entries
(see Figure 7.2 (right)). Therefore, for an approximation using N basis sites, the
action of the resolvent can be computed in O(N 3/2) operations [112].
7.2.2. The computed measures. Figure 7.3 shows how the spectral measure
of H0, taken with respect to the vector e1, varies with Î¦. For Î¦ âˆˆQ, the spectrum is
absolutely continuous, and we show the Radonâ€“Nikodym derivative of the measure,
Ïe1. The calculations, performed with a fourth-order kernel and Ïµ = 0.01, show a
sharp Hofstadter-type butterï¬‚y.12
Figure 7.4 (left) shows an approximation of Ïe1 when Î¦ = 1/4 using a fourth-
order kernel and Ïµ = 0.01. We also show, as shaded vertical strips, the output of
12Hofstadterâ€™s butterï¬‚y [53] is the visual representation of the fractal, self-similar nature of the
spectrum of a Hamiltonian describing non-interacting two-dimensional electrons in a magnetic ï¬eld
in a lattice. The most famous example is for the almost Mathieu operator on â„“2(Z).
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
23
B
0
200
400
600
800
1000
0
100
200
300
400
500
600
700
800
900
1000
Figure 7.2. Left: Honeycomb structure of graphene as a bipartite graph. We have shown the
spinor structure via the circled lattice vertices and the indexing via (m, n). The arrow shows the
perpendicular magnetic ï¬eld B. Right: Sparsity structure of the ï¬rst 103 Ã— 103 block of the inï¬nite
matrix, and the corresponding growing local bandwidth.
-3
-2
-1
0
1
2
3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
10-5
10-4
10-3
10-2
10-1
100
101
Î¦
x
Figure 7.3.
The Radonâ€“Nikodym derivative of the measure for various Î¦, computed with
Ïµ = 0.01. The spectrum is fractal for irrational Î¦, which is approximated by rational Î¦. The small
gaps in the spectrum are clearly visible (corresponding to the blue shaded regions) and the logarithmic
scale shows the sharpness of the approximation to Ïe1, which vanishes in these gaps.
the algorithm in [20] which computes the spectrum with error control (we used an
error bound of 10âˆ’3) and without spectral pollution.13 The support of KÏµ âˆ—Âµf is
the whole real line due to the non-compact support of the kernel K. However, if
x Ì¸âˆˆÎ›(H0), then applying (5.1) directly to the deï¬nition of convolution shows that
|[KÏµ âˆ—Âµf](x)| â‰¤CKÏµm/(Ïµ + dist(x, Î›(H0)))m+1, where CK is the constant in (5.1), so
|[KÏµ âˆ—Âµf](x)| decays rapidly oï¬€of the spectrum. We also consider a multiplication
operator (potential) perturbation, modeling a defect, of the form
(7.3)
V (x) = cos(âˆ¥xâˆ¥2Ï€)
(âˆ¥xâˆ¥2 + 1)2 ,
where x denotes the position of a vertex normalized so each edge has length 1. The
perturbed operator is then H0+V . Since the perturbation is trace class, the absolutely
continuous part of the spectrum remains the same (though the measure changes) and
13With a non-periodic potential (7.3), this is a highly non-trivial problem since ï¬nite truncation
methods typically suï¬€er from spectral pollution inside the convex hull of the essential spectrum.
Preprint for review purposes only.
24
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
-3
-2
-1
0
1
2
3
10-3
10-2
10-1
100
101
102
x
-3
-2
-1
0
1
2
3
10-3
10-2
10-1
100
101
102
x
Figure 7.4.
Left: Smoothed measure with no potential.
We show the algorithm in [20] as
shaded strips (green) for comparison. Right: The same computation but with the added potential
in (7.3). The additional eigenvalues correspond to spikes in the smoothed measure.
the potential induces additional eigenvalues (see Figure 7.4 (right)). Again, we see
that |[KÏµâˆ—Âµf](x)| decays rapidly oï¬€of the spectrum. In particular, the measure is not
corrupted by spikes in the gaps in the essential spectrum or similar artifacts caused
by spectral pollution.
7.3. Example 3: Discrete spectra and Dirac operators. In this example,
we consider the case of the Dirac operator L = DV deï¬ned below. Often this operator
has discrete eigenvalues in the interval (âˆ’1, 1), which forms a gap in the essential
spectrum.
This means that standard Galerkin methods used to compute Î›(DV )
typically suï¬€er from spectral pollution in the gap. That is, as the discretization size
increases, the discrete spectrum of the Galerkin discretization clusters in a way that
does not approximate Î›(DV ). There is a vast literature on methods that seek to
avoid spectral pollution when computing Î›(DV ) [29,63,64,91,104]. The majority of
existing approaches work for certain classes of potentials and avoid spectral pollution
on particular subsets of (âˆ’1, 1). Even for Coulomb-type potentials, spectral pollution
can be a diï¬ƒcult issue to overcome, and computations typically achieve a few digits of
precision for the ground state and a handful of the ï¬rst few excited states. A popular
approach is the so-called kinetic balance condition, which does not always work for
Coulomb potentials [31,67,96]. Our approach does not suï¬€er from spectral pollution
and can compute the ï¬rst thousand eigenvalues to near machine precision accuracy.
7.3.1. Recovering eigenvalues and projections onto eigenspaces. The
dominated convergence theorem applied to (4.3) shows that, for any x âˆˆR, we have
(7.4)
lim
Ïµâ†“0 Ïµ Â· Im (âŸ¨RL(x + iÏµ)f, fâŸ©) =
X
Î»âˆˆÎ›p(L)âˆ©{x}
âŸ¨PÎ»f, fâŸ©.
Moreover, if there is no singular continuous spectra in a neighborhood of x, and x is
not an accumulation point of Î›p(L), then (7.4) can be sharpened to
(7.5)
Ïµ Â· Im (âŸ¨RL(x + iÏµ)f, fâŸ©) =
X
Î»âˆˆÎ›p(L)âˆ©{x}
âŸ¨PÎ»f, fâŸ©+ O(Ïµ).
These formulas allow us to compute the locations of eigenvalues of the operator, and
the corresponding projection coeï¬ƒcients onto the eigenspaces for vectors f.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
25
7.3.2. The Dirac operator. We consider a diï¬€erential operator DV associated
with a coupled ï¬rst-order system of diï¬€erential equations that describes the motion
of a relativistic spin-1/2 particle in a radially symmetric potential V (r), deï¬ned by
DV =

1 + V (r)
âˆ’d
dr + Îº
r
d
dr + Îº
r
âˆ’1 + V (r)

.
Here, Îº = j + 1/2 for j âˆˆZ (related to the angular momentum of the particle) and
DV is a special case of the Dirac operator with a radially symmetric potential [107].
If V satisï¬es suitable conditions [107], then DV is a self-adjoint operator with
essential spectrum supported on (âˆ’âˆ, âˆ’1] âˆª[1, âˆ). Depending on V (r), the spec-
trum may also contain discrete eigenvalues in (âˆ’1, 1). Generally, in computational
chemistry, positive eigenvalues correspond to bound states of a relativistic quantum
electron in the external ï¬eld V , and negative eigenvalues correspond to bound states
of a positron [107].
7.3.3. Computing eigenvalues while avoiding spectral pollution. Assum-
ing that f in (7.4) is not orthogonal to any of the eigenfunctions, it follows from (7.4)
and (7.5) that the positions of the peaks of the function
Î½Ïµ
f(x) := Ïµ Â· Im (âŸ¨RDV (x + iÏµ)f, fâŸ©)
correspond to the eigenvalues. To test this, we consider the case of Îº = âˆ’1 and the
Coulomb-type potentials V (r) = Î³/r for âˆ’
âˆš
3/2 < Î³ < 0. For these potentials, the
eigenvalues are known analytically as [107, Ch. 7]
Ej(DV ) =

1 + Î³2(j +
p
1 âˆ’Î³2)âˆ’2âˆ’1/2
,
j â‰¥0.
Note that the eigenvalues accumulate at 1. This makes computing Ej(DV ) diï¬ƒcult
when j is large, even in the absence of spectral pollution.
Figure 7.5 (left) shows Î½Ïµ
f with Ïµ = 10âˆ’10, f(r) = (
âˆš
2reâˆ’r,
âˆš
2reâˆ’r), and Î³ =
âˆ’0.8. One can robustly compute Î½Ïµ
f for a ï¬xed Ïµ > 0 by using the techniques in sub-
section 6.1 and adaptively selecting the discretization size. For Ïµ = 10âˆ’10, we can
accurately compute E1(DV ), . . . , E1000(DV ) by the location of the local maxima of
Î½Ïµ
f. Moreover, the size of the peaks correspond to âˆ¥PEjfâˆ¥2. Figure 7.5 (left) shows
that âˆ¥PEjfâˆ¥2 decreases at an algebraic rate as j â†’âˆ. If one is not satisï¬ed with
the accuracy of the computed eigenvalues, then one can decrease Ïµ at the expense of
an increased computational cost. In Figure 7.5 (right), we show the absolute error in
the computed eigenvalues Ej(DV ) for j = 0, 5, 10, 100, 500, and 1000 as Ïµ â†“0. We ï¬nd
that our algorithm can resolve hundreds of eigenvalues, even when highly clustered,
to an accuracy of essentially machine precision.
8. Conclusions and additional potential applications. In this paper, we
have developed a general framework for evaluating smoothed approximations to the
spectral measures of self-adjoint operators. We have highlighted the theoretical and
practical aspects of the algorithm in the context of diï¬€erential, integral, and lattice
operators. The resolvent-based framework robustly captures discrete and continuous
spectral properties of the operator, rather than any underlying discretizations, yielding
a ï¬‚exible and eï¬ƒcient method for a variety of spectral problems.
A general computational framework for computing the spectral measure Âµf opens
the door to a new set of algorithms for computing with operators and studying their
Preprint for review purposes only.
26
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
10-6
10-4
10-2
100
10-20
10-15
10-10
10-5
100
3.1
 10-7
3.2
 10-7
3.3
 10-7
1 âˆ’x
Î½Ïµ
f(x)
10-10
10-5
100
10-15
10-10
10-5
100
Ïµ
Absolute Error
Figure 7.5. Left: The function Î½Ïµ
f(x) for x near 1. The sloped dashed line shows the algebraic
decay of âˆ¥PEj fâˆ¥2 (approximately O(jâˆ’3)).
The magniï¬ed region shows the extreme clustering,
where the vertical dashed line corresponding to E1000. Right: The absolute error in the computed
eigenvalues Ej(DV ) for j = 0, 5, 10, 100, 500, 1000 as Ïµ â†“0.
spectral properties. As spectral characterizations of continuous and discrete models
draw renewed interest in the context of data-centered applications, our algorithms
may be useful in understanding the behavior of large real-world networks and new
random graph models. The development of rational kernels and corresponding local
evaluation schemes may also be useful for local explorations of the spectral density
of operators of large ï¬nite dimension, such as in DOS calculations in physics [69] or
real-world networks [28].
Our framework can be used to compute the vector-valued functional calculus via
F(L)f â‰ˆâˆ’1
2Ï€i
Z âˆ
âˆ’âˆ
F(y)
m
X
j=1
[Î±jRL(y âˆ’Ïµaj)f âˆ’Î²jRL(y âˆ’Ïµbj)f] dy,
which is useful in the solution of time-evolution problems. For example, taking F(y) =
exp(âˆ’ity) gives an approximation of the solution to the linear SchrÂ¨odinger equation
with initial state f at time t. The vector-valued functional calculus may also be used to
solve more complicated evolution systems, such as non-autonomous Cauchy problems
and non-linear problems, through splitting methods [71,73]. Therefore, our approach
may aid the development of discretization-oblivious exponential integrators for PDEs
or sampling from stochastic processes with self-adjoint generators [57, Ch. 17].
Appendix A. Convergence rates and error bounds.
In this Appendix, we
prove the pointwise and Lp convergence bounds of KÏµ âˆ—Âµf to Ïf as Ïµ â†“0.
A.1. Pointwise error bounds. The pointwise convergence shows that samples
of KÏµ âˆ—Âµf are meaningful because they converge to Ïf, at a rate determined by the
local regularity of Ïf and the order of the kernel. Recall that in Theorem 5.2, K is
an mth order kernel, the measure Âµf is absolutely continuous on I = (x0 âˆ’Î·, x0 + Î·)
for Î· > 0 and a ï¬xed x0 âˆˆR, and that Ïf âˆˆCn,Î±(I) with Î± âˆˆ[0, 1).
Proof of Theorem 5.2. First, we decompose Ïf into two non-negative parts Ïf =
Ï1 +Ï2, where Ï1 is compactly supported on I and Ï2 vanishes on (x0 âˆ’Î·/2, x0 +Î·/2).
Using the convolution representation for KÏµ âˆ—Âµf, we have
(A.1) |Ïf(x0) âˆ’[KÏµ âˆ—Âµf](x0)|â‰¤

Z
R
KÏµ(y) (Ï1(x0 âˆ’y) âˆ’Ï1(x0)) dy
+

h
KÏµ âˆ—Âµ(r)
f
i
(x0)
.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
27
Here, the measure dÂµ(r)
f (y) = dÂµf(y) âˆ’Ï1(y)dy is non-negative and supported in the
complement of (x0 âˆ’Î·/2, x0 + Î·/2). Since Âµf is a probability measure, we have that
R
R dÂµ(r)
f (y) â‰¤1, and the second term on the right-hand side of (A.1) is bounded by
(A.2)

h
KÏµ âˆ—Âµ(r)
f
i
(x0)
 =

Z
R
KÏµ(x0 âˆ’y)dÂµ(r)
f (y)
 â‰¤
sup
|y|â‰¥Î·/2
|KÏµ(y)| â‰¤
CKÏµm
(Ïµ + Î·
2)m+1 .
where the constant CK is given in Deï¬nition 5.1.
To bound the ï¬rst term in (A.1), we expand Ï1(x0 âˆ’y) using Taylorâ€™s theorem:
(A.3)
Ï1(x0 âˆ’y) =
kâˆ’1
X
j=0
(âˆ’1)jÏ(j)
1 (x0)
j!
yj + (âˆ’1)k Ï(k)
1 (Î¾y)
k!
yk,
k = min(n, m),
where |Î¾y âˆ’x0| â‰¤|y|. We consider two cases separately.
Case (i): n + Î± < m. In this case k = n and we can select Ï1 so that
1
n!
Ï(n)
1

C0,Î±(I) â‰¤C(n, Î±)âˆ¥Ïfâˆ¥Cn,Î±(I)
 1 + Î·âˆ’nâˆ’Î±
,
for some universal constant C(n, Î±) that only depends on n and Î±. Existence of such a
decomposition follows from standard arguments with cut-oï¬€functions. Plugging (A.3)
into (A.1) and applying the vanishing moment condition (Deï¬nition 5.1 (ii)), we obtain
(A.4)
Z
R
KÏµ(y) (Ï1(x0 âˆ’y) âˆ’Ï1(x0)) dy = (âˆ’1)n
Z
R
KÏµ(y)Ï(n)
1 (Î¾y)
n!
yn dy.
Since n < m, we can use the vanishing moment condition again to obtain
(A.5)
Z
R
KÏµ(y)Ï(n)
1 (Î¾y)
n!
yn dy =
Z
R
KÏµ(y)Ï(n)
1 (Î¾y) âˆ’Ï(n)
1 (x0)
n!
yn dy.
Since Ï(n)
1
âˆˆC0,Î±(I) and |Î¾yâˆ’x0| â‰¤|y|, we have |Ï(n)
1 (Î¾y)âˆ’Ï(n)
1 (x0)| â‰¤|Ï(n)
1 |C0,Î±(I)|y|Î±.
Applying this bound to the integrand in (A.5) and changing variables y â†’Ïµy,
(A.6)

Z
R
KÏµ(y)Ï(n)
1 (Î¾y) âˆ’Ï(n)
1 (x0)
n!
yn dy
 â‰¤Ïµn+Î±
n!
Ï(n)
1

C0,Î±(I)
Z
R
|K(y)||y|n+Î± dy.
Recalling our selection of Ï1 and combining (A.6) with (A.2) proves case (i).
Case (ii): n + Î± â‰¥m. In this case k = m and we can select Ï1 such that
2e
Ï(m)
1

âˆâ‰¤C(m)âˆ¥Ïfâˆ¥Cm(I)
 1 + Î·âˆ’m
,
for some universal constant C(m) that only depends on m. Again, existence of such a
decomposition follows from standard arguments with cut-oï¬€functions. Since Ï1 has
compact support in I, we have that Ï1(x0 âˆ’y) = 0 if |y| â‰¥Î·. We split the range of
integration in (A.4), substitute the Taylor expansion in (A.3), and change variables
y â†’Ïµy, to obtain

Z
R
KÏµ(y) (Ï1(x0 âˆ’y) âˆ’Ï1(x0)) dy
 â‰¤|Ï1(x0)|

Z
|y|â‰¥Î·/Ïµ
K(y) dy

+
mâˆ’1
X
j=1
Ïµj
j!
Ï(j)
1 (x0)


Z
|y|<Î·/Ïµ
K(y)yj dy
 + Ïµm
m!
Ï(m)
1

âˆ
Z
|y|<Î·/Ïµ
|K(y)| |y|m dy.
(A.7)
Preprint for review purposes only.
28
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
By the vanishing moment condition (see Deï¬nition 5.1 (ii)), we have that
(A.8)

Z
|y|<Î·/Ïµ
K(y)yj dy
 =

Z
|y|â‰¥Î·/Ïµ
K(y)yj dy
 ,
1 â‰¤j â‰¤m âˆ’1.
Deï¬nition 5.1 (iii) implies that |K(x)||x|m+1 â‰¤|K(x)|(1 + |x|)m+1 â‰¤CK. Substitut-
ing (A.8) into (A.7) with the bound for |K(x)| and integrating, yields an upper bound
for the right hand side of (A.7):
(A.9)
mâˆ’1
X
j=0
Ïµj
j!
Ï(j)
1 (x0)
 2CK
m âˆ’j
 Ïµ
Î·
mâˆ’j
+ Ïµm
m!
Ï(m)
1

âˆ
Z
|y|<Î·/Ïµ
|K(y)| |y|m dy.
Since we can write Ï(j)
1 (x0) as an iterated integral of Ï(m)
1
, we ï¬nd that
Ï(j)
1 (x0) =
Z x0
x0âˆ’Î·
Z t1
x0âˆ’Î·
Â· Â· Â·
Z tmâˆ’jâˆ’1
x0âˆ’Î·
Ï(m)
1
(tmâˆ’j)dtmâˆ’j Â· Â· Â· dt1,
0 â‰¤j â‰¤m âˆ’1,
and so it follows that |Ï(j)
1 (x0)| â‰¤Î·mâˆ’jâˆ¥Ï(m)
1
âˆ¥âˆ. Thus, we have
(A.10)
mâˆ’1
X
j=0
Ïµj
j!
Ï(j)
1 (x0)
 2CK
m âˆ’j
 Ïµ
Î·
mâˆ’j
â‰¤2eCKâˆ¥Ï(m)
1
âˆ¥âˆÏµm.
Recalling our selection of Ï1, case (ii) follows from (A.2), (A.9), and (A.10).
A.2. Lp error bounds. In subsection 5.2 we motivate error bounds for âˆ¥Ïf âˆ’
KÏµ âˆ—Âµfâˆ¥L1 to ensure that the calculation of ionization probabilities is meaningful.
In this subsection, we prove the Lp error bounds stated in Theorem 5.3. It is often
easier to prove these kind of results in Fourier space so we begin by understanding
the regularity properties of bK for an mth order kernel (see Deï¬nition 5.1), where
(A.11)
bK(Ï‰) :=
Z
R
K(x)eâˆ’2Ï€ixÏ‰dx,
Ï‰ âˆˆR.
Lemma A.1 (Regularity of Fourier Transform).
Let K be an mth order kernel
(see Deï¬nition 5.1). For any Î± âˆˆ(0, 1), we have that bK âˆˆCmâˆ’1,Î±(R) and
(A.12)
| bK(Ï‰) âˆ’1| â‰¤| bK(mâˆ’1)|C0,Î±
(m âˆ’1)!
|Ï‰|mâˆ’1+Î±.
Proof. Using (5.1) we can diï¬€erentiate through the integral sign in (A.11) to
conclude that bK is (m âˆ’1)-times continuously diï¬€erentiable. Moreover, (5.1) implies
that bK(mâˆ’1) âˆˆWs,2(R) for any s < 3/2 (see [74] for deï¬nition of fractional Sobolev
spaces). Therefore, bK âˆˆCmâˆ’1,Î±(R) for any Î± âˆˆ(0, 1) [74, Thm. 3.26].
For (A.12), note that the normalization condition (Deï¬nition 5.1 (i)) implies that
bK(0) = 1, while the vanishing moment criterion (Deï¬nition 5.1 (ii)) implies that
( bK)(j)(0) = (âˆ’2Ï€i)j R
R K(x)xjdx = 0 for 1 â‰¤j â‰¤m âˆ’1. The bound (A.12) then
follows by using the (mâˆ’1)th order Taylor expansion for bK at the origin and applying
the HÂ¨older condition to the remainder.
We can now use this to bound the Lp error of a smoothed approximation KÏµ âˆ—g
when g âˆˆWm,p(R) and has compact support.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
29
Lemma A.2. Let K be an mth order kernel and let g be any function such that
g âˆˆWm,p(R) for 1 â‰¤p < âˆand supp(g) âŠ‚I = (a âˆ’Î·, b + Î·) for some Î· > 0. Then,
for any Ïµ > 0, we have that14
(A.13)
âˆ¥[KÏµ âˆ—g] âˆ’gâˆ¥Lp(I) â‰¤2ÏµmCK
m!
âˆ¥g(m)âˆ¥Lp(R) log(1 + (b âˆ’a + 2Î·)/Ïµ).
Proof. Since K âˆˆL1(R), we can deï¬ne the function
(A.14)
Ï†1(x) =
Z x
âˆ’âˆ
K(y)dy âˆ’H(x)
Z
R
K(y)dy =
(R x
âˆ’âˆK(y)dy,
x < 0,
âˆ’
R âˆ
x K(y)dy,
x > 0,
where H(x) denotes the Heaviside step function. Using (5.1) and integrating directly,
we see that Ï†1 âˆˆL2(R). Furthermore, since
R
R K(y)dy = 1, we can diï¬€erentiate Ï†1 in
the sense of tempered distributions to obtain Ï†â€²
1 = K âˆ’Î´0. Taking Fourier transforms,
we see that
(2Ï€iÏ‰)bÏ†1(Ï‰) = bK(Ï‰) âˆ’1.
However, bÏ†1, bK âˆˆL2(R) and hence we must have bÏ†1(Ï‰) = ( bK(Ï‰)âˆ’1)(2Ï€iÏ‰)âˆ’1 almost
everywhere, and in particular that ( bK(Ï‰) âˆ’1)(2Ï€iÏ‰)âˆ’1 âˆˆL2(R).
If m > 1, then by (5.1) and the case deï¬nition of Ï†1 in (A.14), we have Ï†1 âˆˆL1(R)
and hence bÏ†1 can be identiï¬ed with a continuous function.
Furthermore, (A.12)
implies that bÏ†1(0) =
R
R Ï†1(y)dy = 0 and hence we can deï¬ne
Ï†2(x) =
Z x
âˆ’âˆ
Ï†1(y)dy âˆ’H(x)
Z
R
Ï†1(y)dy =
(R x
âˆ’âˆÏ†1(y)dy,
x < 0,
âˆ’
R âˆ
x Ï†1(y)dy,
x > 0.
Again by using (5.1) and integrating directly, we see that Ï†2 âˆˆL2(R). We can take
distributional derivatives and Fourier transforms as before to deduce that bÏ†2(Ï‰) =
( bK(Ï‰) âˆ’1)(2Ï€iÏ‰)âˆ’2 almost everywhere. We continue this argument inductively, us-
ing Lemma A.1, and for j = 2, . . . , m deï¬ne Ï†j(x) =
R x
âˆ’âˆÏ†jâˆ’1(y)dy. The argument
shows that bÏ†j(Ï‰) = ( bK(Ï‰) âˆ’1)(2Ï€iÏ‰)âˆ’j. Using (5.1) and integrating, we have
(A.15)
|Ï†j(x)| â‰¤CK(m âˆ’j)!/(m!(1 + |x|)mâˆ’j+1),
1 â‰¤j â‰¤m.
Let gn âˆˆCâˆ
c (R) for n â‰¥1 be a sequence of functions with supp(gn) âŠ†(a âˆ’Î· âˆ’
nâˆ’1, b+Î· +nâˆ’1) such that âˆ¥g âˆ’gnâˆ¥Wm,p(R) â†’0 as n â†’âˆ. Let Ï†m,Ïµ = Ïµâˆ’1Ï†m(xÏµâˆ’1),
so that
bÏ†m,Ïµ(Ï‰) =
bKÏµ(Ï‰) âˆ’1
(2Ï€iÏµÏ‰)m
It follows, by the convolution theorem and Carlesonâ€™s theorem, that for a.e. x âˆˆR
(A.16)
[KÏµ âˆ—gn](x) âˆ’gn(x) =
Z
R
bKÏµ(Ï‰) âˆ’1
(2Ï€iÏ‰)m (2Ï€iÏ‰)mbgn(Ï‰)e2Ï€iÏ‰xdÏ‰ = Ïµm[Ï†m,Ïµ âˆ—g(m)
n
](x).
Letting Ln = ((b âˆ’a) + 2(Î· + nâˆ’1)), we have [Ï†m,Ïµ âˆ—g(m)
n
](x) = [Ï‡[âˆ’Ln,Ln]Ï†m,Ïµ âˆ—
g(m)
n
](x) for x âˆˆI, where Ï‡U denotes the indicator function of a set U. Moreover,
14The log(1/Ïµ) factor is avoided if extra decayâ€”beyond Deï¬nition 5.1 (iii)â€”is assumed on K.
Preprint for review purposes only.
30
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
Ï‡[âˆ’Ln,Ln]Ï†m,Ïµ âˆˆL1(R) by HÂ¨olderâ€™s inequality. Taking the Lp norm on both sides
of (A.16) and applying Youngâ€™s convolution inequality, yields
(A.17)
âˆ¥[KÏµ âˆ—gn] âˆ’gnâˆ¥Lp(I) â‰¤Ïµmâˆ¥g(m)
n
âˆ¥Lp(R)âˆ¥Ï†m,Ïµâˆ¥L1([âˆ’Ln,Ln]).
By taking the limit n â†’âˆin (A.17), we have that
(A.18)
âˆ¥[KÏµ âˆ—g] âˆ’gâˆ¥Lp(I) â‰¤Ïµmâˆ¥g(m)âˆ¥Lp(R)
Z
|y|â‰¤(bâˆ’a)+2Î·
|Ï†m,Ïµ(y)| dy.
Finally, by (A.15) with j = m, we have that |Ï†m,1(x)| â‰¤CK(m!(1 + |x|))âˆ’1.
Changing variables y â†’Ïµy in the last integral in (A.18), applying the bound for Ï†m,1,
and integrating yields the upper bound in (A.13).
We are now ready to prove the Lp error bounds when 1 â‰¤p < âˆ.
Proof of Theorem 5.3. Let Iâ€² = (a âˆ’Î·/2, b + Î·/2). Since Ïf|I âˆˆWm,p(I), we
can decompose Ïf = Ï1 + Ï2 such that Ï1 is non-negative, supported in I with
2âˆ¥Ï(m)
1
âˆ¥Lp(R)/m! â‰¤C(m)âˆ¥Ïfâˆ¥Wm,p(I)(1 + Î·âˆ’m) for some constant C(m) (that de-
pends only on m) and Ï2 is non-negative with support contained in R \ Iâ€². Therefore,
Ïf = Ï1 on (a, b) and
(A.19) âˆ¥Ïf âˆ’KÏµ âˆ—Âµfâˆ¥Lp((a,b)) â‰¤âˆ¥Ï1 âˆ’KÏµ âˆ—Ï1âˆ¥Lp((a,b)) + âˆ¥KÏµ âˆ—Ï1 âˆ’KÏµ âˆ—Âµfâˆ¥Lp((a,b)).
The ï¬rst term is bounded via Lemma A.2. To bound the second term, we note that the
measure Âµ(r)
f
= Âµf âˆ’Ï1 is non-negative, supported in R \ Iâ€², and has
R
R dÂµ(r)
f (y) â‰¤1.
Applying property (iii) in Deï¬nition 5.1, we see that
âˆ¥KÏµ âˆ—Ï1 âˆ’KÏµ âˆ—Âµfâˆ¥p
Lp((a,b)) â‰¤
Z b
a
 
Ïµâˆ’1
Z
R\Iâ€² |K ((x âˆ’y)/Ïµ)| dÂµ(r)(y)
!p
dx
â‰¤Cp
K(b âˆ’a)(Ïµ + Î·/2)âˆ’(m+1)pÏµmp.
Combining the bounds for the terms in (A.19) concludes the proof.
Acknowledgements. The authors are grateful to St Johnâ€™s College, Cambridge
for funding the ï¬rst author to visit Cornell University, during which the collaboration
started. We thank Anthony Austin and Mikael Slevinsky for carefully reading a draft
version of this manuscript and the referees whose careful comments helped us improve
the manuscript.
REFERENCES
[1] A. Agazzi, J.-P. Eckmann, and G. M. Graf. The colored Hofstadter butterï¬‚y for the honey-
comb lattice. J. Stat. Phys., 156(3):417â€“426, 2014.
[2] W. O. Amrein and V. Georgescu. Characterization of bound states and scattering states in
quantum mechanics. Technical report, Univ., Geneva, 1973.
[3] A. Avila and S. Jitomirskaya. The ten martini problem. Annals of Mathematics, 170:303â€“342,
2009.
[4] Z. Bai and J. W. Silverstein.
Spectral Analysis of Large Dimensional Random Matrices,
volume 20. Springer, 2010.
[5] N. Beer and D. G. Pettifor. The recursion method and the estimation of local densities of
states. In The Electronic Structure of Complex Systems, pages 769â€“777. Springer, 1984.
[6] P. Billingsley. Convergence of Probability Measures. John Wiley & Sons, second edition, 1999.
[7] D. Bilman and T. Trogdon. Numerical inverse scattering for the Toda lattice. Comm. Math.
Phys., 352(2):805â€“879, 2017.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
31
[8] A. BÂ¨ottcher and B. Silbermann. Introduction to large truncated Toeplitz matrices. Springer-
Verlag, New York, 1999.
[9] J. P. Boyd. Chebyshev and Fourier spectral methods. Courier Corporation, 2001.
[10] R. Carmona and J. Lacroix. Spectral Theory of Random SchrÂ¨odinger Operators. Prob. Appl.
BirkhÂ¨auser Boston, 1990.
[11] K. Chang. A physics magic trick: Take 2 sheets of carbon and twist. The New York Times,
Oct 2019.
[12] F. Chatelin. Spectral Approximation of Linear Operators. Academic Press, 1983.
[13] T. S. Chihara.
An Introduction to Orthogonal Polynomials.
Gordon and Breach Science
Publishers, New York-London-Paris, 1978.
[14] E. A. Coddington and N. Levinson.
Theory of Ordinary Diï¬€erential Equations.
Krieger
Publishing, Malabar, FL, 1984.
[15] M. J. Colbrook.
Computing spectral measures and spectral types.
arXiv preprint
arXiv:1908.06721v2, 2019.
[16] M. J. Colbrook. The Foundations of Inï¬nite-Dimensional Spectral Computations. PhD thesis,
University of Cambridge, 2020.
[17] M. J. Colbrook and A. C. Hansen. The foundations of spectral computations via the solvability
complexity index hierarchy: Part I. arXiv:1908.09592, 2019.
[18] M. J. Colbrook and A. C. Hansen. On the inï¬nite-dimensional QR algorithm. Numer. Math.,
143(1):17â€“83, 2019.
[19] M.
J.
Colbrook,
A.
Horning,
and
A.
Townsend.
SpecSolve.
github
(online)
https://github.com/SpecSolve, 2020.
[20] M. J. Colbrook, B. Roman, and A. C. Hansen. How to compute spectra with error control.
Phys. Rev. Lett., 122:250201, 2019.
[21] H. CramÂ´er.
On some classes of nonstationary stochastic processes.
In Proceedings of the
Fourth Berkeley symposium on mathematical statistics and probability, volume 2, pages
57â€“78. University of Los Angeles, Press Berkeley and Los Angeles, 1961.
[22] D. Damanik. Singular continuous spectrum for a class of substitution Hamiltonians. Letters
in Mathematical Physics, 46(4):303â€“311, 1998.
[23] D. Damanik, M. Embree, and A. Gorodetski. Spectral properties of SchrÂ¨odinger operators
arising in the study of quasicrystals. In Mathematics of aperiodic order, pages 307â€“370.
Springer, 2015.
[24] D. Damanik and B. Simon. Jost functions and Jost solutions for Jacobi matrices, I. A necessary
and suï¬ƒcient condition for SzegËo asymptotics. Invent. Math., 165(1):1â€“50, 2006.
[25] P. Deift. Orthogonal Polynomials and Random Matrices: a Riemannâ€“Hilbert Approach, vol-
ume 3 of Courant Lecture Notes. Amer. Math. Soc., Providence, RI, 1999.
[26] F. Dellâ€™Oro and V. Pata. Second order linear evolution equations with general dissipation.
Appl. Math. Opt., 2019.
[27] J. Dombrowski and P. Nevai. Orthogonal polynomials, measures and recurrence relations.
SIAM J. Math. Anal., 17(3):752â€“759, 1986.
[28] K. Dong, A. R. Benson, and D. Bindel. Network density of states. In Proceedings of the
25th ACM SIGKDD International Conference on Knowledge Discovery & Data Mining,
pages 1152â€“1161, 2019.
[29] G. W. F. Drake and S. P. Goldman. Application of discrete-basis-set methods to the Dirac
equation. Phys. Rev. A, 23(5):2093, 1981.
[30] N. Dunford and J. T. Schwartz. Linear Operators: Part II: Spectral Theory: Self Adjoint
Operators in Hilbert Space. Interscience Publishers, 1963.
[31] K. G. Dyall and K. FÃ¦gri Jr. Kinetic balance and variational bounds failure in the solution of
the Dirac equation in a ï¬nite Gaussian basis set. Chem. Phys. Let., 174(1):25â€“32, 1990.
[32] V. D. Efros, W. Leidemann, and G. Orlandini. Response functions from integral transforms
with a Lorentz kernel. Phys. Lett. B, 338(2-3):130â€“133, 1994.
[33] V. D. Efros, W. Leidemann, G. Orlandini, and N. Barnea.
The Lorentz integral trans-
form (LIT) method and its applications to perturbation-induced reactions. J. Phys. G,
34(12):R459, 2007.
[34] V. D. Efros, W. Leidemann, and V. Y. Shalamova. On calculating response functions via their
Lorentz integral transforms. Few-Body Sys., 60(2):35, 2019.
[35] V. Enss.
Asymptotic completeness for quantum mechanical potential scattering.
Comm.
Math. Phys., 61(3):285â€“291, 1978.
[36] L. C. Evans. Partial Diï¬€erential Equations, volume 19. Amer. Math. Soc., second edition,
2010.
[37] K. O. Friedrichs. On the perturbation of continuous spectra. Commun. Pure Appl. Math.,
1(4):361â€“406, 1948.
Preprint for review purposes only.
32
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
[38] C. Fulton, D. Pearson, and S. Pruess. Computing the spectral function for singular Sturmâ€“
Liouville problems. J. Comput. Appl. Math., 176(1):131â€“162, 2005.
[39] C. Fulton, D. Pearson, and S. Pruess. New characterizations of spectral density functions for
singular Sturmâ€“Liouville problems. J. Comput. Appl. Math., 212(2):194â€“213, 2008.
[40] C. Fulton and S. Pruess. The computation of spectral density functions for singular Sturmâ€“
Liouville problems involving simple continuous spectra.
ACM Trans. Math. Soft.,
24(1):107â€“129, 1998.
[41] C. Fulton, S. Pruess, and W. Shoaï¬€. Parallel computation of Sturmâ€“Liouville spectral density
functions. Parallel Algorithms and Applications, 4(1-2):41â€“51, 1994.
[42] F. Gamboa, J. Nagel, and A. Rouault.
Sum rules via large deviations.
J. Func. Anal.,
270(2):509â€“559, 2016.
[43] V. Girardin and R. Senoussi.
Semigroup stationary processes and spectral representation.
Bernoulli, 9(5):857â€“876, 2003.
[44] I. M. Glazman. Direct Methods of Qualitative Spectral Analysis of Singular Diï¬€erential Op-
erators. Israel Program for Scientiï¬c Translations, 1965.
[45] A. Y. Gordon, S. Jitomirskaya, Y. Last, and B. Simon.
Duality and singular continuous
spectrum in the almost Mathieu equation. Acta Mathematica, 178(2):169â€“183, 1997.
[46] K. Gustafson. Operator spectral states. Comput. Math. Appl., 34(5-6):467â€“508, 1997.
[47] B. C. Hall. Quantum Theory for Mathematicians, volume 267 of Graduate Texts in Mathe-
matics. Springer, 2013.
[48] M. Hamzavi, K.-E. Thylwe, and A. Rajabi. Approximate bound states solution of the Hell-
mann potential. Commun. Theor. Phys., 60(1):1, 2013.
[49] R. Haydock, V. Heine, and M. J. Kelly.
Electronic structure based on the local atomic
environment for tight-binding bands. J. Phys. C: Solid State Phys., 5(20):2845, 1972.
[50] H. Hellmann. A new approximation method in the problem of many electrons. J. Chem.
Phys, 3(1):61â€“61, 1935.
[51] M. Hochbruck and A. Ostermann. Exponential integrators. Acta Numerica, 19:209â€“286, 2010.
[52] K. Hoï¬€man. Banach Spaces of Analytic Functions. Prenticeâ€“Hall, 1962.
[53] D. R. Hofstadter. Energy levels and wave functions of Bloch electrons in rational and irrational
magnetic ï¬elds. Physical review B, 14(6):2239, 1976.
[54] A. Horning and A. Townsend. FEAST for diï¬€erential eigenvalue problems. SIAM Journal on
Numerical Analysis, 58(2):1239â€“1262, 2020.
[55] D. Hundertmark, M. Meyries, L. Machinek, and R. Schnaubelt. Operator semigroups and
dispersive equations. In 16th Internet Seminar on Evolution Equations, 2013.
[56] S. Joe. Discrete collocation methods for second kind Fredholm integral equations. SIAM J.
Numer. Anal., 22(6):1167â€“1177, 1985.
[57] O. Kallenberg. Foundations of Modern Probability. Springer Science & Business Media, 2006.
[58] G. Kallianpur and V. Mandrekar. Spectral theory of stationary H-valued processes. J. Mul-
tivar. Anal., 1(1):1â€“16, 1971.
[59] T. Kato. Perturbation Theory for Linear Operators, volume 132. Springer Science & Business
Media, second edition, 1976.
[60] A. Kiejna and K. F. Wojciechowski. Metal Surface Electron Physics. Elsevier, 1996.
[61] R. Killip and B. Simon.
Sum rules for Jacobi matrices and their applications to spectral
theory. Ann. Math., 158:253â€“321, 2003.
[62] W. Koppelman. On the spectral theory of singular integral operators. Trans. Am. Math.
Soc., 97(1):35â€“63, 1960.
[63] W. Kutzelnigg. Basis set expansion of the Dirac operator without variational collapse. Inter.
J. Quant. Chem., 25(1):107â€“129, 1984.
[64] W. Kutzelnigg. Relativistic one-electron Hamiltonians for electrons only and the variational
treatment of the Dirac equation. Chem. Phys., 225(1-3):203â€“222, 1997.
[65] P. W. Langhoï¬€.
Stieltjesâ€“Tchebycheï¬€moment-theory approach to photoeï¬€ect studies in
Hilbert space. In Theory and Applications of Moment Methods in Many-Fermion Sys-
tems, pages 191â€“212. Springer, 1980.
[66] B. M. Levitan and I. S. Sargsian.
Introduction to Spectral Theory: Selfadjoint Ordinary
Diï¬€erential Operators, volume 39 of Translations of Mathematical Monographs. Amer.
Math. Soc., 1975.
[67] M. Lewin and Â´E. SÂ´erÂ´e. Spectral pollution and how to avoid it (with applications to Dirac and
periodic SchrÂ¨odinger operators). Proc. Lond. Math. Soc. (3), 100(3):864â€“900, 2010.
[68] J. Liesen and Z. Strakos. Krylov subspace methods: principles and analysis. Oxford University
Press, Oxford, 2013.
[69] L. Lin, Y. Saad, and C. Yang. Approximating spectral densities of large matrices. SIAM
Rev., 58(1):34â€“65, 2016.
Preprint for review purposes only.
COMPUTING SPECTRAL MEASURES
33
[70] X. Lu, P. Stepanov, W. Yang, et al. Superconductors, orbital magnets and correlated states
in magic-angle bilayer graphene. Nature, 574(7780):653â€“657, 2019.
[71] C. Lubich. From Quantum to Classical Molecular Dynamics: Reduced Models and Numerical
Analysis.
Zurich Lectures in Advanced Mathematics. European Mathematical Society
(EMS), ZÂ¨urich, 2008.
[72] V. A. Marchenko. Sturmâ€“Liouville Operators and Applications, volume 373 of AMS Chelsea
Publishing. Amer. Math. Soc., 2011.
[73] R. I. McLachlan and G. R. W. Quispel. Splitting methods. Acta Numerica, 11:341â€“434, 2002.
[74] W. C. H. McLean. Strongly Elliptic Systems and Boundary Integral Equations. Cambridge
university press, 2000.
[75] C. A. H. Neto, F. Guinea, N. M. R. Peres, K. S. Novoselov, and A. K. Geim. The electronic
properties of graphene. Rev. Modern Phys., 81(1):109, 2009.
[76] K. S. Novoselov. Nobel lecture: Graphene: Materials in the ï¬‚atland. Reviews of Modern
Physics, 83(3):837, 2011.
[77] S. Olver and A. Townsend.
A fast and well-conditioned spectral method.
SIAM Rev.,
55(3):462â€“489, 2013.
[78] E. Parzen. On consistent estimates of the spectrum of a stationary time series. Ann. Math.
Stat., 28:329â€“348, 1957.
[79] E. Parzen. Mathematical considerations in the estimation of spectra. Technometrics, 3(2):167â€“
190, 1961.
[80] E. Parzen. On estimation of a probability density function and mode. Ann. Math. Stats.,
33(3):1065â€“1076, 1962.
[81] A. Pazy. Semigroups of Linear Operators and Applications to Partial Diï¬€erential Equations,
volume 44 of Applied Mathematical Sciences. Springer Science & Business Media, 2012.
[82] L. A. Ponomarenko, R. V. Gorbachev, G. L. Yu, D. C. Elias, R. Jalil, A. A. Patel,
A. Mishchenko, A. S. Mayorov, C. R. Woods, J. R. Wallbank, et al. Cloning of Dirac
fermions in graphene superlattices. Nature, 497(7451):594, 2013.
[83] M. B. Priestley. Basic considerations in the estimation of spectra. Technometrics, 4(4):551â€“
564, 1962.
[84] S. Pruess and C. T. Fulton.
Mathematical software for Sturmâ€“Liouville problems.
ACM
Trans. Math. Soft., 19(3):360â€“376, 1993.
[85] S. Pruess and C. T. Fulton. Error analysis in the approximation of Sturmâ€“Liouville spectral
density functions. J. Math. Anal. Appl., 203(2):518â€“539, 1996.
[86] C. Puelz, M. Embree, and J. Fillman. Spectral approximation for quasiperiodic jacobi oper-
ators. Integral Equations and Operator Theory, 82(4):533â€“554, 2015.
[87] M. Reed and B. Simon. Methods of Modern Mathematical Physics. I. Academic Press, Inc.,
Harcourt Brace Jovanovich, New York, second edition, 1980.
[88] M. Rosenblatt. Remarks on some nonparametric estimates of a density function. Ann. Math.
Stats., 27(3):832â€“837, 1956.
[89] M. Rosenblatt. Stochastic curve estimation, volume 3 of NSF-CBMS Regional Conference
Series in Probability and Statistics. IMS, 1991.
[90] D. Ruelle. A remark on bound states in potential-scattering theory. Il Nuovo Cimento A
(1965-1970), 61(4):655â€“662, 1969.
[91] V. M. Shabaev, I. I. Tupitsyn, V. A. Yerokhin, G. Plunien, and G. Soï¬€. Dual kinetic balance
approach to basis-set expansions for the Dirac equation. Phys. Rev. Lett., 93(13):130405,
2004.
[92] R. N. Silver and H. RÂ¨oder. Densities of states of mega-dimensional Hamiltonian matrices.
Inter. J. Modern Phys. C, 5(04):735â€“753, 1994.
[93] B. W. Silverman. Density Estimation for Statistics and Data Analysis. Routledge, 2018.
[94] B. Simon. SchrÂ¨odinger semigroups. Bull. Am. Math. Soc., 7(3):447â€“526, 1982.
[95] B. Simon.
SzegËoâ€™s theorem and its descendants: Spectral Theory for L2 Perturbations of
Orthogonal Polynomials, volume 6 of Porter Lectures. Princeton university press, 2010.
[96] R. E. Stanton and S. Havriliak. Kinetic balance: A partial solution to the problem of varia-
tional safety in Dirac calculations. J. Chem. Phys., 81(4):1910â€“1918, 1984.
[97] E. M. Stein and R. Shakarchi.
Real Analysis: Measure Theory, Integration, and Hilbert
Spaces. Princeton University Press, 2009.
[98] E. M. Stein and R. Shakarchi. Functional Analysis: Introduction to Further Topics in Analy-
sis, volume 4 of Princeton Lectures in Analysis. Princeton University Press, 2011.
[99] P. Stoica and R. L. Moses. Spectral analysis of signals. Pearson Prentice Hall Upper Saddle
River, NJ, 2005.
[100] M. Stone and P. Goldbart. Mathematics for Physics: a Guided Tour for Graduate Students.
Cambridge University Press, 2009.
Preprint for review purposes only.
34
MATTHEW COLBROOK, ANDREW HORNING, AND ALEX TOWNSEND
[101] M. H. Stone. Linear Transformations in Hilbert Space, volume 15 of Amer. Math. Soc. Colloq.
Pub. Amer. Math. Soc., Providence, RI, 1990.
[102] A. SÂ¨utËo. Singular continuous spectrum on a Cantor set of zero Lebesgue measure for the
Fibonacci Hamiltonian. Journal of statistical physics, 56(3-4):525â€“531, 1989.
[103] G. SzegËo. Orthogonal Polynomials. Amer. Math. Soc., New York, 1939.
[104] J. D. Talman. Minimax principle for the Dirac equation. Phys. Rev. Lett., 57(9):1091, 1986.
[105] D. J. Tannor. Introduction to Quantum Mechanics: a Time-Dependent Perspective. Univer-
sity Science Books, 2007.
[106] G. Teschl.
Jacobi Operators and Completely Integrable Nonlinear Lattices, volume 72 of
Mathematical Surveys and Monographs. Amer. Math. Soc., Providence, RI, 2000.
[107] B. Thaller. The Dirac Equation. Texts and Monographs in Physics. Springer-Verlag, Berlin,
1992.
[108] E. C. Titchmarsh.
Eigenfunction Expansions Associated With Second Order Diï¬€erential
Equations, Part I. Oxford University Press, second edition, 1962.
[109] T. Touhei. A scattering problem by means of the spectral representation of Greenâ€™s function
for a layered acoustic half-space. Comput. Mech., 25(5):477â€“488, 2000.
[110] A. Townsend and L. N. Trefethen. An extension of Chebfun to two dimensions. SIAM J. Sci.
Comput., 35(6):C495â€“C518, 2013.
[111] L. N. Trefethen. Approximation Theory and Approximation Practice, volume 164 of Other
Titles in Applied Mathematics. SIAM, second edition, 2019.
[112] L. N. Trefethen and D. Bau III. Numerical Linear Algebra. SIAM, Philadelphia, PA, 1997.
[113] L. N. Trefethen and J. A. C. Weideman. The exponentially convergent trapezoidal rule. SIAM
Rev., 56(3):385â€“458, 2014.
[114] T. Trogdon, S. Olver, and B. Deconinck.
Numerical inverse scattering for the Kortewegâ€“
de Vries and modiï¬ed Kortewegâ€“de Vries equations.
Phys. D: Nonlinear Pheno.,
241(11):1003â€“1025, 2012.
[115] A. B. Tsybakov. Introduction to Nonparametric Estimation. Springer Science & Business
Media, 2008.
[116] M. P. Wand and M. C. Jones. Kernel Smoothing. Chapman and Hall/CRC, 1994.
[117] M. Webb and S. Olver. Spectra of Jacobi operators via connection coeï¬ƒcient matrices. arXiv
preprint arXiv:1702.03095, 2017.
[118] A. WeiÃŸe, G. Wellein, A. Alvermann, and H. Fehske. The kernel polynomial method. Rev.
Modern Phys., 78(1):275, 2006.
[119] J. Wilkening and A. Cerfon. A spectral transform method for singular Sturmâ€“Liouville prob-
lems with applications to energy diï¬€usion in plasma physics.
SIAM J. Appl. Math.,
75(2):350â€“392, 2015.
Preprint for review purposes only.
